"use strict";var Kt=Object.create;var oe=Object.defineProperty,jt=Object.defineProperties,Vt=Object.getOwnPropertyDescriptor,Ht=Object.getOwnPropertyDescriptors,Bt=Object.getOwnPropertyNames,lt=Object.getOwnPropertySymbols,Xt=Object.getPrototypeOf,ut=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable;var dt=(r,e,t)=>e in r?oe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,J=(r,e)=>{for(var t in e||(e={}))ut.call(e,t)&&dt(r,t,e[t]);if(lt)for(var t of lt(e))zt.call(e,t)&&dt(r,t,e[t]);return r},Y=(r,e)=>jt(r,Ht(e));var Yt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),pt=(r,e)=>{for(var t in e)oe(r,t,{get:e[t],enumerable:!0})},mt=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Bt(e))!ut.call(r,o)&&o!==t&&oe(r,o,{get:()=>e[o],enumerable:!(n=Vt(e,o))||n.enumerable});return r};var Qt=(r,e,t)=>(t=r!=null?Kt(Xt(r)):{},mt(e||!r||!r.__esModule?oe(t,"default",{value:r,enumerable:!0}):t,r)),Zt=r=>mt(oe({},"__esModule",{value:!0}),r);var g=(r,e,t)=>new Promise((n,o)=>{var s=c=>{try{a(t.next(c))}catch(d){o(d)}},i=c=>{try{a(t.throw(c))}catch(d){o(d)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(s,i);a((t=t.apply(r,e)).next())});var Ct=Yt((On,Ye)=>{"use strict";var Hr=Object.prototype.hasOwnProperty,M="~";function de(){}Object.create&&(de.prototype=Object.create(null),new de().__proto__||(M=!1));function Br(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function At(r,e,t,n,o){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new Br(t,n||r,o),i=M?M+e:e;return r._events[i]?r._events[i].fn?r._events[i]=[r._events[i],s]:r._events[i].push(s):(r._events[i]=s,r._eventsCount++),r}function Te(r,e){--r._eventsCount===0?r._events=new de:delete r._events[e]}function b(){this._events=new de,this._eventsCount=0}b.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Hr.call(t,n)&&e.push(M?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};b.prototype.listeners=function(e){var t=M?M+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,s=n.length,i=new Array(s);o<s;o++)i[o]=n[o].fn;return i};b.prototype.listenerCount=function(e){var t=M?M+e:e,n=this._events[t];return n?n.fn?1:n.length:0};b.prototype.emit=function(e,t,n,o,s,i){var a=M?M+e:e;if(!this._events[a])return!1;var c=this._events[a],d=arguments.length,u,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,o),!0;case 5:return c.fn.call(c.context,t,n,o,s),!0;case 6:return c.fn.call(c.context,t,n,o,s,i),!0}for(h=1,u=new Array(d-1);h<d;h++)u[h-1]=arguments[h];c.fn.apply(c.context,u)}else{var S=c.length,I;for(h=0;h<S;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),d){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,n);break;case 4:c[h].fn.call(c[h].context,t,n,o);break;default:if(!u)for(I=1,u=new Array(d-1);I<d;I++)u[I-1]=arguments[I];c[h].fn.apply(c[h].context,u)}}return!0};b.prototype.on=function(e,t,n){return At(this,e,t,n,!1)};b.prototype.once=function(e,t,n){return At(this,e,t,n,!0)};b.prototype.removeListener=function(e,t,n,o){var s=M?M+e:e;if(!this._events[s])return this;if(!t)return Te(this,s),this;var i=this._events[s];if(i.fn)i.fn===t&&(!o||i.once)&&(!n||i.context===n)&&Te(this,s);else{for(var a=0,c=[],d=i.length;a<d;a++)(i[a].fn!==t||o&&!i[a].once||n&&i[a].context!==n)&&c.push(i[a]);c.length?this._events[s]=c.length===1?c[0]:c:Te(this,s)}return this};b.prototype.removeAllListeners=function(e){var t;return e?(t=M?M+e:e,this._events[t]&&Te(this,t)):(this._events=new de,this._eventsCount=0),this};b.prototype.off=b.prototype.removeListener;b.prototype.addListener=b.prototype.on;b.prefixed=M;b.EventEmitter=b;typeof Ye<"u"&&(Ye.exports=b)});var yn={};pt(yn,{Extension:()=>_,MagicExtensionError:()=>B,MagicExtensionWarning:()=>ee,MagicRPCError:()=>O,MagicSDKError:()=>L,MagicSDKWarning:()=>q,SDKBase:()=>he,STORE_KEY_PRIVATE_KEY:()=>Se,STORE_KEY_PUBLIC_JWK:()=>pe,TypedEmitter:()=>be,ViewController:()=>De,clearKeys:()=>tn,createDeprecationWarning:()=>U,createDuplicateIframeWarning:()=>Gr,createExtensionNotInitializedError:()=>Ve,createIncompatibleExtensionsError:()=>He,createInvalidArgumentError:()=>Be,createJwt:()=>rt,createMalformedResponseError:()=>je,createMissingApiKeyError:()=>Ge,createModalNotReadyError:()=>Ke,createPromiEvent:()=>P,createPromise:()=>we,createReactNativeEndpointConfigurationWarning:()=>ze,createSDK:()=>xt,createSynchronousWeb3MethodWarning:()=>Xe,createTypedEmitter:()=>ue,createURL:()=>Ne,decodeJSON:()=>Fe,encodeJSON:()=>le,getPayloadId:()=>Ie,isEmpty:()=>Z,isJsonRpcErrorCode:()=>Je,isJsonRpcRequestPayload:()=>Wr,isJsonRpcResponsePayload:()=>We,isMagicPayloadMethod:()=>Jr,isMajorVersionAtLeast:()=>Ze,isPromiEvent:()=>Qe,isWebCryptoSupported:()=>re,storage:()=>te,uuid:()=>tt});module.exports=Zt(yn);function er(r){let e={exports:{}};return r(e,e.exports),e.exports}var tr=Number.MAX_SAFE_INTEGER||9007199254740991;var Ue={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:tr,MAX_SAFE_COMPONENT_LENGTH:16},rr=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{},E=rr,ce=er(function(r,e){let{MAX_SAFE_COMPONENT_LENGTH:t}=Ue,n=(e=r.exports={}).re=[],o=e.src=[],s=e.t={},i=0,a=(c,d,u)=>{let h=i++;E(h,d),s[c]=h,o[h]=d,n[h]=new RegExp(d,u?"g":void 0)};a("NUMERICIDENTIFIER","0|[1-9]\\d*"),a("NUMERICIDENTIFIERLOOSE","[0-9]+"),a("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),a("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),a("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),a("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),a("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),a("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),a("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),a("BUILDIDENTIFIER","[0-9A-Za-z-]+"),a("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),a("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),a("FULL",`^${o[s.FULLPLAIN]}$`),a("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),a("LOOSE",`^${o[s.LOOSEPLAIN]}$`),a("GTLT","((?:<|>)?=?)"),a("XRANGEIDENTIFIERLOOSE",`${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),a("XRANGEIDENTIFIER",`${o[s.NUMERICIDENTIFIER]}|x|X|\\*`),a("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),a("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),a("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),a("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),a("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),a("COERCERTL",o[s.COERCE],!0),a("LONETILDE","(?:~>?)"),a("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",a("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),a("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),a("LONECARET","(?:\\^)"),a("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",a("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),a("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),a("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),a("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),a("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",a("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),a("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),a("STAR","(<|>)?=?\\s*\\*"),a("GTE0","^\\s*>=\\s*0.0.0\\s*$"),a("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}),ht=/^[0-9]+$/,bt=(r,e)=>{let t=ht.test(r),n=ht.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},nr=(r,e)=>bt(e,r),sr={compareIdentifiers:bt,rcompareIdentifiers:nr},{MAX_LENGTH:ft,MAX_SAFE_INTEGER:Ee}=Ue,{re:Et,t:gt}=ce,{compareIdentifiers:ie}=sr,y=class{constructor(e,t){if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof y){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>ft)throw new TypeError(`version is longer than ${ft} characters`);E("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?Et[gt.LOOSE]:Et[gt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Ee||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ee||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ee||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<Ee)return s}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(E("SemVer.compare",this.version,this.options,e),!(e instanceof y)){if(typeof e=="string"&&e===this.version)return 0;e=new y(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof y||(e=new y(e,this.options)),ie(this.major,e.major)||ie(this.minor,e.minor)||ie(this.patch,e.patch)}comparePre(e){if(e instanceof y||(e=new y(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],o=e.prerelease[t];if(E("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n!==o)return ie(n,o)}while(++t)}compareBuild(e){e instanceof y||(e=new y(e,this.options));let t=0;do{let n=this.build[t],o=e.build[t];if(E("prerelease compare",t,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n!==o)return ie(n,o)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let n=this.prerelease.length;for(;--n>=0;)typeof this.prerelease[n]=="number"&&(this.prerelease[n]++,n=-2);n===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}},or=(r,e,t)=>new y(r,t).compare(new y(e,t)),Q=or,ir=(r,e,t)=>Q(r,e,t)===0,ar=ir,cr=(r,e,t)=>Q(r,e,t)!==0,lr=cr,dr=(r,e,t)=>Q(r,e,t)>0,ur=dr,pr=(r,e,t)=>Q(r,e,t)>=0,mr=pr,hr=(r,e,t)=>Q(r,e,t)<0,fr=hr,Er=(r,e,t)=>Q(r,e,t)<=0,gr=Er,yr=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return ar(r,t,n);case"!=":return lr(r,t,n);case">":return ur(r,t,n);case">=":return mr(r,t,n);case"<":return fr(r,t,n);case"<=":return gr(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}},qe=yr,ae=Symbol("SemVer ANY"),G=class{static get ANY(){return ae}constructor(e,t){if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof G){if(e.loose===!!t.loose)return e;e=e.value}E("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ae?this.value="":this.value=this.operator+this.semver.version,E("comp",this)}parse(e){let t=this.options.loose?yt[Rt.COMPARATORLOOSE]:yt[Rt.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new y(n[2],this.options.loose):this.semver=ae}toString(){return this.value}test(e){if(E("Comparator.test",e,this.options.loose),this.semver===ae||e===ae)return!0;if(typeof e=="string")try{e=new y(e,this.options)}catch(t){return!1}return qe(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof G))throw new TypeError("a Comparator is required");if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),this.operator==="")return this.value===""||new k(e.value,t).test(this.value);if(e.operator==="")return e.value===""||new k(this.value,t).test(e.semver);let n=!(this.operator!==">="&&this.operator!==">"||e.operator!==">="&&e.operator!==">"),o=!(this.operator!=="<="&&this.operator!=="<"||e.operator!=="<="&&e.operator!=="<"),s=this.semver.version===e.semver.version,i=!(this.operator!==">="&&this.operator!=="<="||e.operator!==">="&&e.operator!=="<="),a=qe(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=qe(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||o||s&&i||a||c}},{re:yt,t:Rt}=ce,k=class{constructor(e,t){if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof k)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new k(e.raw,t);if(e instanceof G)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let{loose:t}=this.options;e=e.trim();let n=t?T[R.HYPHENRANGELOOSE]:T[R.HYPHENRANGE];e=e.replace(n,Cr(this.options.includePrerelease)),E("hyphen replace",e),e=e.replace(T[R.COMPARATORTRIM],Rr),E("comparator trim",e,T[R.COMPARATORTRIM]),e=(e=(e=e.replace(T[R.TILDETRIM],vr)).replace(T[R.CARETTRIM],Ir)).split(/\s+/).join(" ");let o=t?T[R.COMPARATORLOOSE]:T[R.COMPARATOR];return e.split(" ").map(s=>Tr(s,this.options)).join(" ").split(/\s+/).map(s=>Ar(s,this.options)).filter(this.options.loose?s=>!!s.match(o):()=>!0).map(s=>new G(s,this.options))}intersects(e,t){if(!(e instanceof k))throw new TypeError("a Range is required");return this.set.some(n=>vt(n,t)&&e.set.some(o=>vt(o,t)&&n.every(s=>o.every(i=>s.intersects(i,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new y(e,this.options)}catch(t){return!1}for(let t=0;t<this.set.length;t++)if($r(this.set[t],e,this.options))return!0;return!1}},{re:T,t:R,comparatorTrimReplace:Rr,tildeTrimReplace:vr,caretTrimReplace:Ir}=ce,vt=(r,e)=>{let t=!0,n=r.slice(),o=n.pop();for(;t&&n.length;)t=n.every(s=>o.intersects(s,e)),o=n.pop();return t},Tr=(r,e)=>(E("comp",r,e),r=wr(r,e),E("caret",r),r=br(r,e),E("tildes",r),r=Mr(r,e),E("xrange",r),r=Nr(r,e),E("stars",r),r),x=r=>!r||r.toLowerCase()==="x"||r==="*",br=(r,e)=>r.trim().split(/\s+/).map(t=>Pr(t,e)).join(" "),Pr=(r,e)=>{let t=e.loose?T[R.TILDELOOSE]:T[R.TILDE];return r.replace(t,(n,o,s,i,a)=>{let c;return E("tilde",r,n,o,s,i,a),x(o)?c="":x(s)?c=`>=${o}.0.0 <${+o+1}.0.0-0`:x(i)?c=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:a?(E("replaceTilde pr",a),c=`>=${o}.${s}.${i}-${a} <${o}.${+s+1}.0-0`):c=`>=${o}.${s}.${i} <${o}.${+s+1}.0-0`,E("tilde return",c),c})},wr=(r,e)=>r.trim().split(/\s+/).map(t=>xr(t,e)).join(" "),xr=(r,e)=>{E("caret",r,e);let t=e.loose?T[R.CARETLOOSE]:T[R.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(o,s,i,a,c)=>{let d;return E("caret",r,o,s,i,a,c),x(s)?d="":x(i)?d=`>=${s}.0.0${n} <${+s+1}.0.0-0`:x(a)?d=s==="0"?`>=${s}.${i}.0${n} <${s}.${+i+1}.0-0`:`>=${s}.${i}.0${n} <${+s+1}.0.0-0`:c?(E("replaceCaret pr",c),d=s==="0"?i==="0"?`>=${s}.${i}.${a}-${c} <${s}.${i}.${+a+1}-0`:`>=${s}.${i}.${a}-${c} <${s}.${+i+1}.0-0`:`>=${s}.${i}.${a}-${c} <${+s+1}.0.0-0`):(E("no pr"),d=s==="0"?i==="0"?`>=${s}.${i}.${a}${n} <${s}.${i}.${+a+1}-0`:`>=${s}.${i}.${a}${n} <${s}.${+i+1}.0-0`:`>=${s}.${i}.${a} <${+s+1}.0.0-0`),E("caret return",d),d})},Mr=(r,e)=>(E("replaceXRanges",r,e),r.split(/\s+/).map(t=>Sr(t,e)).join(" ")),Sr=(r,e)=>{r=r.trim();let t=e.loose?T[R.XRANGELOOSE]:T[R.XRANGE];return r.replace(t,(n,o,s,i,a,c)=>{E("xRange",r,n,o,s,i,a,c);let d=x(s),u=d||x(i),h=u||x(a),S=h;return o==="="&&S&&(o=""),c=e.includePrerelease?"-0":"",d?n=o===">"||o==="<"?"<0.0.0-0":"*":o&&S?(u&&(i=0),a=0,o===">"?(o=">=",u?(s=+s+1,i=0,a=0):(i=+i+1,a=0)):o==="<="&&(o="<",u?s=+s+1:i=+i+1),o==="<"&&(c="-0"),n=`${o+s}.${i}.${a}${c}`):u?n=`>=${s}.0.0${c} <${+s+1}.0.0-0`:h&&(n=`>=${s}.${i}.0${c} <${s}.${+i+1}.0-0`),E("xRange return",n),n})},Nr=(r,e)=>(E("replaceStars",r,e),r.trim().replace(T[R.STAR],"")),Ar=(r,e)=>(E("replaceGTE0",r,e),r.trim().replace(T[e.includePrerelease?R.GTE0PRE:R.GTE0],"")),Cr=r=>(e,t,n,o,s,i,a,c,d,u,h,S,I)=>`${t=x(n)?"":x(o)?`>=${n}.0.0${r?"-0":""}`:x(s)?`>=${n}.${o}.0${r?"-0":""}`:i?`>=${t}`:`>=${t}${r?"-0":""}`} ${c=x(d)?"":x(u)?`<${+d+1}.0.0-0`:x(h)?`<${d}.${+u+1}.0-0`:S?`<=${d}.${u}.${h}-${S}`:r?`<${d}.${u}.${+h+1}-0`:`<=${c}`}`.trim(),$r=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(E(r[n].semver),r[n].semver!==G.ANY&&r[n].semver.prerelease.length>0){let o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0},Pt=(r,e,t)=>{try{e=new k(e,t)}catch(n){return!1}return e.test(r)};var{MAX_LENGTH:Lr}=Ue,{re:It,t:Tt}=ce,Or=(r,e)=>{if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),r instanceof y)return r;if(typeof r!="string"||r.length>Lr||!(e.loose?It[Tt.LOOSE]:It[Tt.FULL]).test(r))return null;try{return new y(r,e)}catch(t){return null}},_r=Or,{re:ge,t:ye}=ce,wt=(r,e)=>{if(r instanceof y)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;let t=null;if((e=e||{}).rtl){let n;for(;(n=ge[ye.COERCERTL].exec(r))&&(!t||t.index+t[0].length!==r.length);)t&&n.index+n[0].length===t.index+t[0].length||(t=n),ge[ye.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;ge[ye.COERCERTL].lastIndex=-1}else t=r.match(ge[ye.COERCE]);return t===null?null:_r(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};function kr(r){return String.fromCharCode(parseInt(r.slice(1),16))}function Dr(r){return`%${`00${r.charCodeAt(0).toString(16)}`.slice(-2)}`}function qr(r){return btoa(encodeURIComponent(r).replace(/%[0-9A-F]{2}/g,kr))}function Ur(r){return decodeURIComponent(Array.from(atob(r),Dr).join(""))}function le(r){return qr(JSON.stringify(r))}function Fe(r){return JSON.parse(Ur(r))}var N=require("@magic-sdk/types");var Re=require("@magic-sdk/types");function D(r){return typeof r=="undefined"}function Fr(r){return r===null}function ve(r){return Fr(r)||D(r)}function Wr(r){return ve(r)?!1:!D(r.jsonrpc)&&!D(r.id)&&!D(r.method)&&!D(r.params)}function We(r){return ve(r)?!1:!D(r.jsonrpc)&&!D(r.id)&&(!D(r.result)||!D(r.error))}function Jr(r){return ve(r)?!1:typeof r=="string"&&Object.values(Re.MagicPayloadMethod).includes(r)}function Je(r){return ve(r)?!1:typeof r=="number"&&Object.values(Re.RPCErrorCode).includes(r)}function Z(r){if(!r)return!0;for(let e in r)if(Object.hasOwnProperty.call(r,e))return!1;return!0}var f={};function xt(r,e){return Object.assign(f,e),r}var Mt={"magic-sdk":"magic-sdk","@magic-sdk/react-native":"magic-sdk-rn","@magic-sdk/react-native-bare":"magic-sdk-rn-bare","@magic-sdk/react-native-expo":"magic-sdk-rn-expo"};var L=class extends Error{constructor(t,n){super(`Magic SDK Error: [${t}] ${n}`);this.code=t;this.rawMessage=n;this.__proto__=Error;Object.setPrototypeOf(this,L.prototype)}},O=class extends Error{constructor(t){super();this.__proto__=Error;let n=Number(t==null?void 0:t.code);this.rawMessage=(t==null?void 0:t.message)||"Internal error",this.code=Je(n)?n:N.RPCErrorCode.InternalError,this.message=`Magic RPC Error: [${this.code}] ${this.rawMessage}`,this.data=(t==null?void 0:t.data)||void 0,Object.setPrototypeOf(this,O.prototype)}},q=class{constructor(e,t){this.code=e;this.rawMessage=t;this.message=`Magic SDK Warning: [${e}] ${t}`}log(){console.warn(this.message)}},B=class extends Error{constructor(t,n,o,s){super(`Magic Extension Error (${t.name}): [${n}] ${o}`);this.code=n;this.rawMessage=o;this.data=s;this.__proto__=Error;Object.setPrototypeOf(this,B.prototype)}},ee=class{constructor(e,t,n){this.code=t;this.rawMessage=n;this.message=`Magic Extension Warning (${e.name}): [${t}] ${n}`}log(){console.warn(this.message)}};function Ge(){return new L(N.SDKErrorCode.MissingApiKey,"Please provide an API key that you acquired from the Magic developer dashboard.")}function Ke(){return new L(N.SDKErrorCode.ModalNotReady,"Modal is not ready.")}function je(){return new L(N.SDKErrorCode.MalformedResponse,"Response from the Magic iframe is malformed.")}function Ve(r){return new L(N.SDKErrorCode.ExtensionNotInitialized,`Extensions must be initialized with a Magic SDK instance before \`Extension.${r}\` can be accessed. Do not invoke \`Extension.${r}\` inside an extension constructor.`)}function He(r){let e=`Some extensions are incompatible with \`${f.sdkName}@${f.version}\`:`;return r.filter(t=>typeof t.compat!="undefined"&&t.compat!==null).forEach(t=>{let n=t.compat[f.sdkName];typeof n=="string"?e+=`
  - Extension \`${t.name}\` supports version(s) \`${n}\``:n||(e+=`
  - Extension \`${t.name}\` does not support ${f.platform} environments.`)}),new L(N.SDKErrorCode.IncompatibleExtensions,e)}function Be(r){let e=t=>{let n=t+1,o=n%10,s=n%100;return o===1&&s!==11?`${n}st`:o===2&&s!==12?`${n}nd`:o===3&&s!==13?`${n}rd`:`${n}th`};return new L(N.SDKErrorCode.InvalidArgument,`Invalid ${e(r.argument)} argument given to \`${r.procedure}\`.
  Expected: \`${r.expected}\`
  Received: \`${r.received}\``)}function Gr(){return new q(N.SDKWarningCode.DuplicateIframe,"Duplicate iframes found.")}function Xe(){return new q(N.SDKWarningCode.SyncWeb3Method,"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.")}function ze(){return new q(N.SDKWarningCode.ReactNativeEndpointConfiguration,`CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \`endpoint\` parameter SHOULD NOT be provided. The Magic \`<iframe>\` is automatically wrapped by a WebView pointed at \`${f.defaultEndpoint}\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`)}function U(r){let{method:e,removalVersions:t,useInstead:n}=r,o=t[f.sdkName],s=n?` Use \`${n}\` instead.`:"",i=`\`${e}\` will be removed from \`${f.sdkName}\` in version \`${o}\`.${s}`;return new q(N.SDKWarningCode.DeprecationNotice,i)}var p=require("@magic-sdk/types");var j=require("@magic-sdk/types");function*Kr(){let r=0;for(;;)r<Number.MAX_SAFE_INTEGER?yield++r:r=0}var jr=Kr();function Ie(){return jr.next().value}var St=Symbol("Payload pre-processed by Magic SDK");function Nt(r){return Object.defineProperty(r,St,{value:!0,enumerable:!1}),r}function Vr(r){return!!r[St]}function X(r){var e,t,n;return Vr(r)||(r.jsonrpc=(e=r.jsonrpc)!=null?e:"2.0",r.id=Ie(),r.method=(t=r.method)!=null?t:"noop",r.params=(n=r.params)!=null?n:[],Nt(r)),r}function m(r,e=[]){return Nt({params:e,method:r,jsonrpc:"2.0",id:Ie()})}var K=class{constructor(e){e instanceof K?(this._jsonrpc=e.payload.jsonrpc,this._id=e.payload.id,this._result=e.payload.result,this._error=e.payload.error):We(e)?(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=e.result,this._error=e.error):(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=void 0,this._error=void 0)}applyError(e){return this._error=e,this}applyResult(e){return this._result=e,this}get hasError(){return typeof this._error!="undefined"&&this._error!==null}get hasResult(){return typeof this._result!="undefined"}get payload(){return{jsonrpc:this._jsonrpc,id:this._id,result:this._result,error:this._error}}};var Pe=require("@magic-sdk/types");var $t=Qt(Ct()),be=class extends $t.default{};function ue(){let r=new be;return{emitter:r,createChainingEmitterMethod:(n,o)=>(...s)=>(r[n].apply(r,s),o),createBoundEmitterMethod:n=>(...o)=>r[n].apply(r,o)}}var Lt=Symbol("isPromiEvent");function Qe(r){return!!r[Lt]}function P(r){let e=we(r),{createBoundEmitterMethod:t,createChainingEmitterMethod:n}=ue(),o=Symbol("Promise.then"),s=Symbol("Promise.catch"),i=Symbol("Promise.finally"),a=(u,h)=>(...S)=>{let I=h[u].apply(h,S);return c(I)},c=u=>Object.assign(u,{[Lt]:!0,[o]:u[o]||u.then,[s]:u[s]||u.catch,[i]:u[i]||u.finally,then:a(o,u),catch:a(s,u),finally:a(i,u),on:n("on",u),once:n("once",u),addListener:n("addListener",u),off:n("off",u),removeListener:n("removeListener",u),removeAllListeners:n("removeAllListeners",u),emit:t("emit"),eventNames:t("eventNames"),listeners:t("listeners"),listenerCount:t("listenerCount")}),d=c(e.then(u=>(d.emit("done",u),d.emit("settled"),u),u=>{throw d.emit("error",u),d.emit("settled"),u}));return d.on(Pe.UserEventsOnReceived.ClosedByUser,()=>{d.emit(Pe.UserEventsEmit.ClosedByUser)}),d}function we(r){return new Promise((e,t)=>{let n=r(e,t);Promise.resolve(n).catch(t)})}var v=class{constructor(e){this.sdk=e}get overlay(){return this.sdk.overlay}request(e){if(this.sdk.thirdPartyWallets.isConnected&&!j.routeToMagicMethods.includes(e.method))return P((i,a)=>{this.sdk.thirdPartyWallets.requestOverride(e).then(i).catch(a)});let t=this.overlay.post(j.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,X(e)),n=P((s,i)=>{t.then(a=>{if(o(),a.hasError)i(new O(a.payload.error));else if(a.hasResult)s(a.payload.result);else throw je()}).catch(a=>{o(),i(a)})}),o=this.overlay.on(j.MagicIncomingWindowMessage.MAGIC_HANDLE_EVENT,s=>{var a;let{response:i}=s.data;if(i.id===e.id&&((a=i.result)==null?void 0:a.event)){let{event:c,params:d=[]}=i.result;n.emit(c,...d)}});return n}createIntermediaryEvent(e,t){return o=>{let s=m(j.MagicPayloadMethod.IntermediaryEvent,[{payloadId:t,eventType:e,args:o}]);this.request(s)}}};function Ze(r,e){let[t]=r.split(".").map(Number);return t>=e}var z={"magic-sdk":"v18.0.0","@magic-sdk/react-native":"v14.0.0","@magic-sdk/react-native-bare":"v19.0.0","@magic-sdk/react-native-expo":"v19.0.0"},xe=class extends v{loginWithMagicLink(e){let t=f.sdkName==="@magic-sdk/react-native"||f.sdkName==="@magic-sdk/react-native-bare"||f.sdkName==="@magic-sdk/react-native-expo";if(t&&Ze(f.version,19))throw new Error("loginWithMagicLink() is deprecated for this package, please utlize a passcode method like loginWithSMS or loginWithEmailOTP instead.");t&&U({method:"auth.loginWithMagicLink()",removalVersions:z,useInstead:"auth.loginWithEmailOTP()"}).log();let{email:n,showUI:o=!0,redirectURI:s,overrides:i,lifespan:a}=e,c=m(this.sdk.testMode?p.MagicPayloadMethod.LoginWithMagicLinkTestMode:p.MagicPayloadMethod.LoginWithMagicLink,[{email:n,showUI:o,redirectURI:s,overrides:i,lifespan:a}]);return this.request(c)}loginWithSMS(e){let{phoneNumber:t,showUI:n=!0,lifespan:o}=e,s=m(this.sdk.testMode?p.MagicPayloadMethod.LoginWithSmsTestMode:p.MagicPayloadMethod.LoginWithSms,[{phoneNumber:t,showUI:n,lifespan:o}]),i=this.request(s);return!n&&i&&(i.on(p.LoginWithSmsOTPEventEmit.VerifySmsOtp,a=>{this.createIntermediaryEvent(p.LoginWithSmsOTPEventEmit.VerifySmsOtp,s.id)(a)}),i.on(p.LoginWithSmsOTPEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.LoginWithSmsOTPEventEmit.Cancel,s.id)()})),i}loginWithEmailOTP(e){let{email:t,showUI:n,deviceCheckUI:o,overrides:s,lifespan:i}=e,a=m(this.sdk.testMode?p.MagicPayloadMethod.LoginWithEmailOTPTestMode:p.MagicPayloadMethod.LoginWithEmailOTP,[{email:t,showUI:n,deviceCheckUI:o,overrides:s,lifespan:i}]),c=this.request(a);return!o&&c&&c.on(p.DeviceVerificationEventEmit.Retry,()=>{this.createIntermediaryEvent(p.DeviceVerificationEventEmit.Retry,a.id)()}),!n&&c&&(c.on(p.LoginWithEmailOTPEventEmit.VerifyEmailOtp,d=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.VerifyEmailOtp,a.id)(d)}),c.on(p.LoginWithEmailOTPEventEmit.VerifyMFACode,d=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.VerifyMFACode,a.id)(d)}),c.on(p.LoginWithEmailOTPEventEmit.LostDevice,()=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.LostDevice,a.id)()}),c.on(p.LoginWithEmailOTPEventEmit.VerifyRecoveryCode,d=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.VerifyRecoveryCode,a.id)(d)}),c.on(p.LoginWithEmailOTPEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.LoginWithEmailOTPEventEmit.Cancel,a.id)()})),c}loginWithCredential(e){let{credentialOrQueryString:t,lifespan:n}=e||{},o=t!=null?t:"";if(!t&&f.platform==="web"){o=window.location.search;let i=window.location.origin+window.location.pathname;window.history.replaceState(null,"",i)}let s=m(this.sdk.testMode?p.MagicPayloadMethod.LoginWithCredentialTestMode:p.MagicPayloadMethod.LoginWithCredential,[o,n]);return this.request(s)}setAuthorizationToken(e){let t=m(p.MagicPayloadMethod.SetAuthorizationToken,[{jwt:e}]);return this.request(t)}updateEmailWithUI(e){let{email:t,showUI:n=!0}=e,o=m(this.sdk.testMode?p.MagicPayloadMethod.UpdateEmailTestMode:p.MagicPayloadMethod.UpdateEmail,[{email:t,showUI:n}]),s=this.request(o);return n||(s.on(p.RecencyCheckEventEmit.Retry,()=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.Retry,o.id)()}),s.on(p.RecencyCheckEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.Cancel,o.id)()}),s.on(p.RecencyCheckEventEmit.VerifyEmailOtp,i=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.VerifyEmailOtp,o.id)(i)}),s.on(p.RecencyCheckEventEmit.VerifyMFACode,i=>{this.createIntermediaryEvent(p.RecencyCheckEventEmit.VerifyMFACode,o.id)(i)}),s.on(p.UpdateEmailEventEmit.RetryWithNewEmail,i=>{this.createIntermediaryEvent(p.UpdateEmailEventEmit.RetryWithNewEmail,o.id)(i)}),s.on(p.UpdateEmailEventEmit.Cancel,()=>{this.createIntermediaryEvent(p.UpdateEmailEventEmit.Cancel,o.id)()}),s.on(p.UpdateEmailEventEmit.VerifyEmailOtp,i=>{this.createIntermediaryEvent(p.UpdateEmailEventEmit.VerifyEmailOtp,o.id)(i)})),s}};var l=require("@magic-sdk/types");var te={};pt(te,{clear:()=>Xr,getItem:()=>w,iterate:()=>et,key:()=>Yr,keys:()=>Qr,length:()=>zr,removeItem:()=>F,setItem:()=>C});var Me;function V(r){return(...e)=>g(this,null,function*(){return Me||(Me=yield f.configureStorage()),yield Me.ready(),Me[r](...e)})}var w=V("getItem"),C=V("setItem"),F=V("removeItem"),Xr=V("clear"),zr=V("length"),Yr=V("key"),Qr=V("keys"),et=V("iterate");function tt(){let r=window.crypto.getRandomValues(new Uint8Array(16));r[6]=r[6]&15|64,r[8]=r[8]&191|128;let e="";return e+=r[0].toString(16),e+=r[1].toString(16),e+=r[2].toString(16),e+=r[3].toString(16),e+="-",e+=r[4].toString(16),e+=r[5].toString(16),e+="-",e+=r[6].toString(16),e+=r[7].toString(16),e+="-",e+=r[8].toString(16),e+=r[9].toString(16),e+="-",e+=r[10].toString(16),e+=r[11].toString(16),e+=r[12].toString(16),e+=r[13].toString(16),e+=r[14].toString(16),e+=r[15].toString(16),e}var Se="STORE_KEY_PRIVATE_KEY",pe="STORE_KEY_PUBLIC_JWK",_t="ECDSA",Zr="P-256",en={name:_t,namedCurve:Zr};function re(){let r=typeof window!="undefined"&&!!window.crypto,e=r&&!!window.crypto.subtle;return r&&e}function tn(){F(pe),F(Se)}function rt(){return g(this,null,function*(){let r=yield rn();if(!r){console.info("unable to create public key or webcrypto is unsupported");return}let{subtle:e}=window.crypto,t=yield w(Se);if(!t||!e){console.info("unable to find private key or webcrypto unsupported");return}let n={iat:Math.floor(new Date().getTime()/1e3),jti:tt()},o={typ:"dpop+jwt",alg:"ES256",jwk:r},s={protected:Ot(JSON.stringify(o)),claims:Ot(JSON.stringify(n))},i=sn(`${s.protected}.${s.claims}`),a={name:_t,hash:{name:"SHA-256"}},c=an(new Uint8Array(yield e.sign(a,t,i)));return`${s.protected}.${s.claims}.${c}`})}function rn(){return g(this,null,function*(){if(!re()){console.info("webcrypto is not supported");return}return(yield w(pe))||(yield nn()),w(pe)})}function nn(){return g(this,null,function*(){let{subtle:r}=window.crypto,e=yield r.generateKey(en,!1,["sign"]),t=yield r.exportKey("jwk",e.publicKey);yield C(Se,e.privateKey),yield C(pe,t)})}function Ot(r){return kt(on(r))}function sn(r){return new TextEncoder().encode(r)}function kt(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+/g,"")}function on(r){return encodeURIComponent(r).replace(/%([0-9A-F]{2})/g,(t,n)=>String.fromCharCode(parseInt(n,16)))}function an(r){let e="";return r.forEach(t=>{e+=String.fromCharCode(t)}),kt(e)}var nt="ds",st="ek",ot="iv",it="AES-GCM",cn=256;function ne(){return g(this,null,function*(){let r=[];yield et((e,t,n)=>{t.startsWith(`${nt}_`)&&r.push(t)});for(let e of r)yield F(e)})}function Dt(r){let e="",t=new Uint8Array(r),n=t.byteLength;for(let o=0;o<n;o++)e+=String.fromCharCode(t[o]);return window.btoa(e)}function qt(r){let e=window.atob(r),t=e.length,n=new Uint8Array(t);for(let o=0;o<t;o++)n[o]=e.charCodeAt(o);return n.buffer}function ln(){return g(this,null,function*(){if(!re()){console.info("webcrypto is not supported");return}let{crypto:r}=window,e=yield w(ot);return e||r.getRandomValues(new Uint8Array(12))})}function dn(){return g(this,null,function*(){if(!re()){console.info("webcrypto is not supported");return}let{subtle:r}=window.crypto,e=yield w(st);return e||(yield r.generateKey({name:it,length:cn},!1,["encrypt","decrypt"]))})}function Ut(r,e){return g(this,null,function*(){let t=yield ln(),n=yield dn();if(!t||!n||!r)return;let o=qt(r),{subtle:s}=window.crypto,i=yield s.encrypt({name:it,iv:t},n,o),a=Dt(i);yield C(`${nt}_${e}`,a),yield C(st,n),yield C(ot,t)})}function Ft(r){return g(this,null,function*(){let e=yield w(`${nt}_${r}`),t=yield w(ot),n=yield w(st);if(!t||!e||!n||!re())return;let{subtle:o}=window.crypto,s=yield o.decrypt({name:it,iv:t},n,qt(e));return Dt(s)})}function Ne(r,e){return e?new URL(r,e):new URL(r)}var Ae=class extends v{constructor(){super(...arguments);this.localForageIsLoggedInKey="magic_auth_is_logged_in";this.userLoggedOutCallbacks=[]}getIdToken(t){let n=m(this.sdk.testMode?l.MagicPayloadMethod.GetIdTokenTestMode:l.MagicPayloadMethod.GetIdToken,[t]);return this.request(n)}generateIdToken(t){let n=m(this.sdk.testMode?l.MagicPayloadMethod.GenerateIdTokenTestMode:l.MagicPayloadMethod.GenerateIdToken,[t]);return this.request(n)}getInfo(){let t=m(l.MagicPayloadMethod.GetInfo,[]);return this.request(t)}isLoggedIn(){return P((t,n)=>g(this,null,function*(){try{let o=!1;this.sdk.useStorageCache&&(o=(yield w(this.localForageIsLoggedInKey))==="true",o&&t(!0));let s=m(this.sdk.testMode?l.MagicPayloadMethod.IsLoggedInTestMode:l.MagicPayloadMethod.IsLoggedIn),i=yield this.request(s);this.sdk.useStorageCache&&(i?C(this.localForageIsLoggedInKey,!0):F(this.localForageIsLoggedInKey),o&&!i&&this.emitUserLoggedOut(!0)),t(i)}catch(o){n(o)}}))}logout(){return F(this.localForageIsLoggedInKey),ne(),P((t,n)=>g(this,null,function*(){try{let o=m(this.sdk.testMode?l.MagicPayloadMethod.LogoutTestMode:l.MagicPayloadMethod.Logout),s=yield this.request(o);this.sdk.useStorageCache&&this.emitUserLoggedOut(s),t(s)}catch(o){n(o)}}))}requestInfoWithUI(t){let n=m(l.MagicPayloadMethod.RequestUserInfoWithUI,t?[t]:[]);return this.request(n)}showSettings(t){let{showUI:n=!0}=t||{},o=m(this.sdk.testMode?l.MagicPayloadMethod.UserSettingsTestMode:l.MagicPayloadMethod.UserSettings,[t]),s=this.request(o);return!n&&s&&(s.on(l.RecoveryFactorEventEmit.SendNewPhoneNumber,i=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.SendNewPhoneNumber,o.id)(i)}),s.on(l.RecoveryFactorEventEmit.SendOtpCode,i=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.SendOtpCode,o.id)(i)}),s.on(l.RecoveryFactorEventEmit.StartEditPhoneNumber,()=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.StartEditPhoneNumber,o.id)()}),s.on(l.RecoveryFactorEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.RecoveryFactorEventEmit.Cancel,o.id)()}),s.on(l.RecencyCheckEventEmit.VerifyEmailOtp,i=>{this.createIntermediaryEvent(l.RecencyCheckEventEmit.VerifyEmailOtp,o.id)(i)})),s}recoverAccount(t){let{email:n,showUI:o}=t,s=m(this.sdk.testMode?l.MagicPayloadMethod.RecoverAccountTestMode:l.MagicPayloadMethod.RecoverAccount,[{email:n,showUI:o}]),i=this.request(s);return!o&&i&&(i.on(l.RecoverAccountEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.Cancel,s.id)()}),i.on(l.RecoverAccountEventEmit.ResendSms,()=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.ResendSms,s.id)()}),i.on(l.RecoverAccountEventEmit.VerifyOtp,a=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.VerifyOtp,s.id)(a)}),i.on(l.RecoverAccountEventEmit.UpdateEmail,a=>{this.createIntermediaryEvent(l.RecoverAccountEventEmit.UpdateEmail,s.id)(a)}),i.on(l.UpdateEmailEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.UpdateEmailEventEmit.Cancel,s.id)()}),i.on(l.UpdateEmailEventEmit.RetryWithNewEmail,a=>{this.createIntermediaryEvent(l.UpdateEmailEventEmit.RetryWithNewEmail,s.id)(a)}),i.on(l.UpdateEmailEventEmit.VerifyEmailOtp,a=>{this.createIntermediaryEvent(l.UpdateEmailEventEmit.VerifyEmailOtp,s.id)(a)})),i}revealPrivateKey(){let t=m(l.MagicPayloadMethod.RevealPK);return this.request(t)}getMetadata(){U({method:"user.getMetadata()",removalVersions:z,useInstead:"user.getInfo()"}).log();let t=m(this.sdk.testMode?l.MagicPayloadMethod.GetMetadataTestMode:l.MagicPayloadMethod.GetMetadata);return this.request(t)}onUserLoggedOut(t){this.userLoggedOutCallbacks.push(t)}enableMFA(t){let{showUI:n=!0}=t,o=m(l.MagicPayloadMethod.EnableMFA,[{showUI:n}]),s=this.request(o);return!n&&s&&(s.on(l.EnableMFAEventEmit.VerifyMFACode,i=>{this.createIntermediaryEvent(l.EnableMFAEventEmit.VerifyMFACode,o.id)(i)}),s.on(l.EnableMFAEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.EnableMFAEventEmit.Cancel,o.id)()})),s}disableMFA(t){let{showUI:n=!0}=t,o=m(l.MagicPayloadMethod.DisableMFA,[{showUI:n}]),s=this.request(o);return!n&&s&&(s.on(l.DisableMFAEventEmit.VerifyMFACode,i=>{this.createIntermediaryEvent(l.DisableMFAEventEmit.VerifyMFACode,o.id)(i)}),s.on(l.DisableMFAEventEmit.LostDevice,i=>{this.createIntermediaryEvent(l.DisableMFAEventEmit.LostDevice,o.id)(i)}),s.on(l.DisableMFAEventEmit.Cancel,()=>{this.createIntermediaryEvent(l.DisableMFAEventEmit.Cancel,o.id)()})),s}emitUserLoggedOut(t){this.userLoggedOutCallbacks.forEach(n=>{n(t)})}};var $=require("@magic-sdk/types");var Ce=class extends v{connectWithUI(e){let t=P((n,o)=>g(this,null,function*(){try{let s=m($.MagicPayloadMethod.Login,[J({enabledWallets:this.sdk.thirdPartyWallets.enabledWallets},e)]),i=this.request(s);this.sdk.thirdPartyWallets.eventListeners.forEach(({event:c,callback:d})=>{i.on(c,()=>d(s.id))}),i.on("id-token-created",c=>{t.emit("id-token-created",c)});let a=yield i;a.error&&o(a),n(a)}catch(s){o(s)}}));return t}showUI(e){return this.request(m($.MagicPayloadMethod.ShowUI,[e]))}showAddress(){return this.request(m($.MagicPayloadMethod.ShowAddress))}showSendTokensUI(){return this.request(m($.MagicPayloadMethod.ShowSendTokensUI))}showOnRamp(){return this.request(m($.MagicPayloadMethod.ShowOnRamp))}showNFTs(){return this.request(m($.MagicPayloadMethod.ShowNFTs))}showBalances(){return this.request(m($.MagicPayloadMethod.ShowBalances))}sendGaslessTransaction(e,t){return this.request(m($.MagicPayloadMethod.SendGaslessTransaction,[e,t]))}getInfo(){U({method:"wallet.getInfo()",removalVersions:z,useInstead:"user.getInfo()"}).log();let e=m($.MagicPayloadMethod.GetInfo,[]);return this.request(e)}disconnect(){U({method:"wallet.disconnect()",removalVersions:z,useInstead:"user.logout()"}).log(),ne();let e=m($.MagicPayloadMethod.Disconnect);return this.request(e)}requestUserInfoWithUI(e){U({method:"wallet.requestUserInfoWithUI()",removalVersions:z,useInstead:"user.requestUserInfoWithUI()"}).log();let t=m($.MagicPayloadMethod.RequestUserInfoWithUI,e?[e]:[]);return this.request(t)}};var A=require("@magic-sdk/types");var $e=class extends v{constructor(){super(...arguments);this.eventListeners=[];this.enabledWallets={};this.isConnected=!1}resetThirdPartyWalletState(){localStorage.removeItem(A.LocalStorageKeys.PROVIDER),localStorage.removeItem(A.LocalStorageKeys.ADDRESS),localStorage.removeItem(A.LocalStorageKeys.CHAIN_ID),this.isConnected=!1}requestOverride(t){if(t.method===A.MagicPayloadMethod.Login)return this.resetThirdPartyWalletState(),super.request(t);if(t.method===A.MagicPayloadMethod.GetInfo)return this.getInfo(t);if(t.method===A.MagicPayloadMethod.IsLoggedIn)return this.isLoggedIn(t);if(t.method===A.MagicPayloadMethod.Logout)return this.logout(t);switch(localStorage.getItem(A.LocalStorageKeys.PROVIDER)){case"web3modal":return this.web3modalRequest(t);default:return this.resetThirdPartyWalletState(),super.request(t)}}isLoggedIn(t){switch(localStorage.getItem(A.LocalStorageKeys.PROVIDER)){case"web3modal":return this.web3modalIsLoggedIn();default:return this.resetThirdPartyWalletState(),super.request(t)}}getInfo(t){switch(localStorage.getItem(A.LocalStorageKeys.PROVIDER)){case"web3modal":return this.web3modalGetInfo();default:return this.resetThirdPartyWalletState(),super.request(t)}}logout(t){let n=localStorage.getItem(A.LocalStorageKeys.PROVIDER);switch(this.resetThirdPartyWalletState(),n){case"web3modal":return this.web3modalLogout();default:return super.request(t)}}web3modalRequest(t){return P((n,o)=>{this.sdk.web3modal.modal.getWalletProvider().request(t).then(n).catch(o)})}web3modalIsLoggedIn(){return P(t=>{let n=this.sdk.web3modal.modal.getStatus();if(n==="connected"&&t(!0),n==="disconnected"&&(this.resetThirdPartyWalletState(),t(!1)),n==="reconnecting"){let o=this.sdk.web3modal.modal.subscribeProvider(({status:s})=>{s==="connected"&&(o(),t(!0)),s==="disconnected"&&(o(),this.resetThirdPartyWalletState(),t(!1))})}})}formatWeb3modalGetInfoResponse(){var o;let t=(o=this.sdk.web3modal.modal.getWalletInfo())==null?void 0:o.name,n=this.sdk.web3modal.modal.getAddress();return{publicAddress:n,email:null,issuer:`did:ethr:${n}`,phoneNumber:null,isMfaEnabled:!1,recoveryFactors:[],walletType:t||"web3modal"}}web3modalGetInfo(){return P((t,n)=>{let o=this.sdk.web3modal.modal.getStatus();if(o==="connected"&&t(this.formatWeb3modalGetInfoResponse()),o==="disconnected"&&(this.resetThirdPartyWalletState(),n("Magic RPC Error: [-32603] Internal error: User denied account access.")),o==="reconnecting"){let s=this.sdk.web3modal.modal.subscribeProvider(({status:i})=>{i==="connected"&&(s(),t(this.formatWeb3modalGetInfoResponse())),i==="disconnected"&&(s(),this.resetThirdPartyWalletState(),n("Magic RPC Error: [-32603] Internal error: User denied account access."))})}})}web3modalLogout(){return P(t=>g(this,null,function*(){try{yield this.sdk.web3modal.modal.disconnect()}catch(n){console.error(n)}t(!0)}))}};var me=require("@magic-sdk/types");var{createBoundEmitterMethod:Le,createChainingEmitterMethod:se}=ue(),Oe=class extends v{constructor(){super(...arguments);this.isMagic=!0;this.on=se("on",this);this.once=se("once",this);this.addListener=se("addListener",this);this.off=se("off",this);this.removeListener=se("removeListener",this);this.removeAllListeners=se("removeAllListeners",this);this.emit=Le("emit");this.eventNames=Le("eventNames");this.listeners=Le("listeners");this.listenerCount=Le("listenerCount")}sendAsync(t,n){if(!n)throw Be({procedure:"Magic.rpcProvider.sendAsync",argument:1,expected:"function",received:n===null?"null":typeof n});if(Array.isArray(t))this.overlay.post(me.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,t.map(o=>{let s=X(o);return this.prefixPayloadMethodForTestMode(s),s})).then(o=>{n(null,o.map(s=>Y(J({},s.payload),{error:s.hasError?new O(s.payload.error):null})))});else{let o=X(t);this.prefixPayloadMethodForTestMode(o),this.overlay.post(me.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,o).then(s=>{n(s.hasError?new O(s.payload.error):null,s.payload)})}}send(t,n){if(typeof t=="string"){let s=m(t,Array.isArray(n)?n:[]);return this.request(s)}if(Array.isArray(t)||!!n){this.sendAsync(t,n);return}let o=Xe();return o.log(),new K(t).applyError({code:-32603,message:o.rawMessage}).payload}enable(){let t=m(me.MagicPayloadMethod.Login);return this.request(t)}request(t){return this.prefixPayloadMethodForTestMode(t),super.request(t)}prefixPayloadMethodForTestMode(t){let n="testMode/eth/";this.sdk.testMode&&(t.method=`${n}${t.method}`)}};var Wt=["request","overlay","sdk"];function un(r){let e=Object.getPrototypeOf(r),t=[e];for(;e!==v.prototype;)e=Object.getPrototypeOf(e),t.push(e);return t}var _e=class extends v{constructor(){super(void 0);this.__sdk_access_field_descriptors__=new Map;this.__is_initialized__=!1;this.utils={createPromiEvent:P,isPromiEvent:Qe,encodeJSON:le,decodeJSON:Fe,createJsonRpcRequestPayload:m,standardizeJsonRpcRequestPayload:X,storage:te};let t=[this,...un(this)];Wt.forEach(n=>{let o=t.map(c=>Object.getOwnPropertyDescriptor(c,n)),s=o.findIndex(c=>!!c),i=s>0,a=o[s];a&&(this.__sdk_access_field_descriptors__.set(n,{descriptor:a,isPrototypeField:i}),Object.defineProperty(this,n,{configurable:!0,get:()=>{throw Ve(n)}}))})}init(t){this.__is_initialized__||(Wt.forEach(n=>{if(this.__sdk_access_field_descriptors__.has(n)){let{descriptor:o,isPrototypeField:s}=this.__sdk_access_field_descriptors__.get(n);s?delete this[n]:Object.defineProperty(this,n,o)}}),this.sdk=t,this.__is_initialized__=!0)}createDeprecationWarning(t){let{method:n,removalVersion:o,useInstead:s}=t,i=s?` Use \`${s}\` instead.`:"",a=`\`${n}\` will be removed from this Extension in version \`${o}\`.${i}`;return new ee(this,"DEPRECATION_NOTICE",a)}createWarning(t,n){return new ee(this,t,n)}createError(t,n,o){return new B(this,t,n,o)}},at=class extends _e{},_=class extends _e{};_.Internal=at,_.Anonymous="anonymous extension";var W=require("@magic-sdk/types");var ke=class extends v{purchase(e){let t=m(W.MagicPayloadMethod.NFTPurchase,[e]);return this.request(t)}checkout(e){let t=this.sdk.thirdPartyWallets.isConnected,n=m(W.MagicPayloadMethod.NFTCheckout,[Y(J({},e),{walletProvider:t?"web3modal":"magic"})]),o=this.request(n);return t&&(o.on(W.NftCheckoutIntermediaryEvents.Initiated,s=>g(this,null,function*(){try{let i=yield this.request({method:"eth_sendTransaction",params:[s]});this.createIntermediaryEvent(W.NftCheckoutIntermediaryEvents.Success,n.id)(i)}catch(i){this.createIntermediaryEvent(W.NftCheckoutIntermediaryEvents.Failure,n.id)()}})),o.on(W.NftCheckoutIntermediaryEvents.Disconnect,()=>{this.sdk.thirdPartyWallets.resetThirdPartyWalletState(),o.emit("disconnect")})),o}transfer(e){let t=m(W.MagicPayloadMethod.NFTTransfer,[e]);return this.request(t)}};function Jt(r){return r.compat&&r.compat[f.sdkName]!=null?typeof r.compat[f.sdkName]=="string"?Pt(wt(f.version),r.compat[f.sdkName]):!!r.compat[f.sdkName]:!0}function pn(r,e,t){return!e&&!t?`${r}_eth_mainnet`:t?`${r}_${JSON.stringify(t)}`:e?typeof e=="string"?`${r}_eth_${e}`:`${r}_${e.rpcUrl}_${e.chainId}_${e.chainType}`:`${r}_unknown`}function mn(r){var o;let e=(o=r==null?void 0:r.extensions)!=null?o:[],t={},n=[];if(Array.isArray(e)?e.forEach(s=>{Jt(s)?(s.init(this),(s.name||s.name!==_.Anonymous)&&(this[s.name]=s),s instanceof _.Internal&&(Z(s.config)||(t[s.name]=s.config))):n.push(s)}):Object.keys(e).forEach(s=>{if(Jt(e[s])){e[s].init(this);let i=e[s];this[s]=i,i instanceof _.Internal&&(Z(i.config)||(t[e[s].name]=i.config))}else n.push(e[s])}),n.length)throw He(n);return t}var fe=class{constructor(e,t){this.apiKey=e;var i;if(!e)throw Ge();f.platform==="react-native"&&(t==null?void 0:t.endpoint)&&ze().log();let{defaultEndpoint:n,version:o}=f;this.testMode=!!(t!=null&&t.testMode),this.useStorageCache=!!(t!=null&&t.useStorageCache),this.endpoint=Ne((i=t==null?void 0:t.endpoint)!=null?i:n).origin,this.auth=new xe(this),this.user=new Ae(this),this.wallet=new Ce(this),this.nft=new ke(this),this.thirdPartyWallets=new $e(this),this.rpcProvider=new Oe(this);let s=mn.call(this,t);this.parameters=le(Y(J({API_KEY:this.apiKey,DOMAIN_ORIGIN:window.location?window.location.origin:"",ETH_NETWORK:t==null?void 0:t.network,host:Ne(this.endpoint).host,sdk:Mt[f.sdkName],version:o,ext:Z(s)?void 0:s,locale:(t==null?void 0:t.locale)||"en_US"},f.bundleId?{bundleId:f.bundleId}:{}),{meta:t==null?void 0:t.meta})),this.networkHash=pn(this.apiKey,t==null?void 0:t.network,Z(s)?void 0:s),t!=null&&t.deferPreload||this.preload()}get overlay(){if(!fe.__overlays__.has(this.parameters)){let e=new f.ViewController(this.endpoint,this.parameters,this.networkHash);e.init(),fe.__overlays__.set(this.parameters,e)}return fe.__overlays__.get(this.parameters)}preload(){return g(this,null,function*(){yield this.overlay.checkIsReadyForRequest})}},he=fe;he.__overlays__=new Map;var H=require("@magic-sdk/types");function hn(r,e){return e&&Array.isArray(r)?r.find(t=>t.id===e):r}function fn(r,e){var o;let t=(o=e.data.response)==null?void 0:o.id,n=hn(r,t);if(t&&n){let s=new K(n).applyResult(e.data.response.result).applyError(e.data.response.error);return{id:t,response:s}}return{}}function En(r,e,t){return g(this,null,function*(){var a;let n=yield w("rt"),o;if(f.platform==="web")try{o=(a=yield w("jwt"))!=null?a:yield rt()}catch(c){console.error("webcrypto error",c)}let s={msgType:r,payload:e};o&&(s.jwt=o),o&&n&&(s.rt=n);let i=yield Ft(t);return i&&(s.deviceShare=i),s})}function gn(r){return g(this,null,function*(){!r.data.rt||(yield C("rt",r.data.rt))})}var De=class{constructor(e,t,n){this.endpoint=e;this.parameters=t;this.networkHash=n;this.messageHandlers=new Set;this.isConnectedToInternet=!0;this.checkIsReadyForRequest=this.waitForReady(),this.isReadyForRequest=!1,this.listen()}post(e,t){return g(this,null,function*(){return we((n,o)=>g(this,null,function*(){if(!this.isConnectedToInternet){let u=Ke();o(u)}this.isReadyForRequest||(yield this.waitForReady());let s=[],i=Array.isArray(t)?t.map(u=>u.id):[],a=yield En(`${e}-${this.parameters}`,t,this.networkHash);yield this._post(a);let c=u=>h=>{var ct;let{id:S,response:I}=fn(t,h);if(gn(h),((ct=I==null?void 0:I.payload.error)==null?void 0:ct.message)==="User denied account access.")ne();else if(h.data.deviceShare){let{deviceShare:Gt}=h.data;Ut(Gt,this.networkHash)}S&&I&&Array.isArray(t)&&i.includes(S)?(s.push(I),s.length===t.length&&(u(),n(s))):S&&I&&!Array.isArray(t)&&S===t.id&&(u(),n(I))},d=this.on(H.MagicIncomingWindowMessage.MAGIC_HANDLE_RESPONSE,c(()=>d()))}))})}on(e,t){let n=t.bind(window),o=s=>{s.data.msgType===`${e}-${this.parameters}`&&n(s)};return this.messageHandlers.add(o),()=>this.messageHandlers.delete(o)}waitForReady(){return new Promise(e=>{let t=this.on(H.MagicIncomingWindowMessage.MAGIC_OVERLAY_READY,()=>{this.isReadyForRequest=!0,e(),t()});setTimeout(()=>{this.isReadyForRequest=!0,e(),t()},15e3)})}listen(){this.on(H.MagicIncomingWindowMessage.MAGIC_HIDE_OVERLAY,()=>{this.hideOverlay()}),this.on(H.MagicIncomingWindowMessage.MAGIC_SHOW_OVERLAY,()=>{this.showOverlay()}),this.on(H.MagicIncomingWindowMessage.MAGIC_SEND_PRODUCT_ANNOUNCEMENT,e=>{e.data.response.result.product_announcement&&new q(H.SDKWarningCode.ProductAnnouncement,e.data.response.result.product_announcement).log()})}};
//# sourceMappingURL=index.js.map
