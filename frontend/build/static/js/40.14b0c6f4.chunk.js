"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[40],{40:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var a=r(43),s=r(3),o=r(837),c=r(749),n=r(816),i=r(510),l=r(579);const d=()=>{const{user:e}=(0,s.d4)((e=>e.auth)),[t,r]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[h,m]=(0,a.useState)(null),g=(0,o.Zp)(),p=(0,s.wA)();(0,a.useEffect)((()=>{(async()=>{try{const e=await c.A.getUserDocuments();r(e),u(!1)}catch(e){m("Failed to fetch documents"),u(!1)}})()}),[]);return d?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsx)("div",{children:"Loading..."})}):(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Dashboard"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsx)("button",{onClick:()=>{g("/documents/create")},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Create Document"}),(0,l.jsx)("button",{onClick:async()=>{try{await n.A.logout(),p((0,i.ri)()),g("/login")}catch(e){console.error("Logout failed",e)}},className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Logout"})]})]}),(0,l.jsx)("div",{className:"bg-white shadow-md rounded-lg",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Welcome, ",null===e||void 0===e?void 0:e.email]}),(0,l.jsxs)("section",{className:"mt-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Your Documents"}),h&&(0,l.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:h}),0===t.length?(0,l.jsx)("div",{className:"text-gray-500 text-center py-6",children:"No documents found. Create your first document!"}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map((e=>(0,l.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition",children:[(0,l.jsx)("h4",{className:"font-semibold mb-2",children:e.title||"Untitled Document"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Created: ",new Date(e.createdAt).toLocaleDateString()]}),(0,l.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,l.jsx)("button",{onClick:()=>g("/documents/".concat(e.id)),className:"text-blue-500 hover:underline",children:"View Details"}),(0,l.jsx)("span",{className:"text-sm text-gray-500",children:e.status})]})]},e.id)))})]})]})})]})}},816:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(722),s=r(590);const o=new class{constructor(){this.magic=new s.qM("pk_live_76B8059F716253F6"),this.api=a.A.create({baseURL:"http://localhost:3000/api"})}async login(e){try{await this.magic.auth.loginWithMagicLink({email:e});const t=await this.magic.user.getMetadata(),r=await this.api.post("/auth/magic-link",{email:t.email});return localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.user)),r.data}catch(t){throw console.error("Login error",t),t}}async register(e){try{const t=await this.api.post("/auth/register",e);return localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user)),t.data}catch(t){throw console.error("Registration error",t),t}}async logout(){try{await this.magic.user.logout(),localStorage.removeItem("token"),localStorage.removeItem("user")}catch(e){console.error("Logout error",e)}}isAuthenticated(){return!!localStorage.getItem("token")}getCurrentUser(){return JSON.parse(localStorage.getItem("user"))}async getProfile(){try{return(await this.api.get("/auth/profile")).data.user}catch(e){throw console.error("Profile fetch error",e),e}}}},749:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(722);const s=new class{constructor(){this.api=a.A.create({baseURL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"http://localhost:3000/api",REACT_APP_BLOCKCHAIN_NETWORK:"xdc_testnet",REACT_APP_BLOCKCHAIN_PROVIDER:"https://rpc.apothem.network",REACT_APP_DOCUMENT_MANAGEMENT_CONTRACT_ADDRESS:"0x74612C664b12416adAcE50Be0E1b1ad6994ce23D",REACT_APP_DOCUMENT_REGISTRY_CONTRACT_ADDRESS:"0xEFc265999C254438e3D595c004e9Fbec3d6cD39a",REACT_APP_MAGIC_PUBLISHABLE_KEY:"pk_live_76B8059F716253F6"}.REACT_APP_API_URL||"http://localhost:3000/api"}),this.api.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e))),this.api.interceptors.response.use((e=>e),(e=>{if(!e.response)throw e.request?new Error("No response from server"):new Error("Error setting up request");switch(e.response.status){case 401:this.handleUnauthorized();break;case 403:throw new Error("Access denied");case 404:throw new Error("Resource not found");case 500:throw new Error("Server error");default:throw new Error(e.response.data.message||"An unexpected error occurred")}}))}handleUnauthorized(){localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"}async createDocument(e){try{return(await this.api.post("/documents/create",e)).data}catch(t){this.handleError(t,"Document creation failed")}}async verifyDocument(e){try{return(await this.api.post("/documents/".concat(e,"/verify"))).data}catch(t){this.handleError(t,"Document verification failed")}}async transferDocument(e,t){try{return(await this.api.post("/documents/".concat(e,"/transfer"),{recipientId:t})).data}catch(r){this.handleError(r,"Document transfer failed")}}async getUserDocuments(){try{return(await this.api.get("/documents")).data.documents||[]}catch(e){this.handleError(e,"Failed to fetch documents")}}async getDocumentById(e){try{return(await this.api.get("/documents/".concat(e))).data}catch(t){this.handleError(t,"Failed to fetch document")}}handleError(e,t){if(e.response){const r=e.response.data.message||t;throw console.error("API Error:",r),new Error(r)}throw e.request?(console.error("Network Error:",e.request),new Error("Network error. Please check your connection.")):(console.error("Request Setup Error:",e.message),new Error(t))}isTransferable(e){return"Transferable"===e.documentType}getStatusColor(e){switch(e){case"Draft":default:return"text-gray-500";case"Active":return"text-green-500";case"Verified":return"text-blue-500";case"Transferred":return"text-purple-500";case"Revoked":return"text-red-500"}}}}}]);
//# sourceMappingURL=40.14b0c6f4.chunk.js.map