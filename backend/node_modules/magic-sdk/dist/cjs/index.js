"use strict";var nt=Object.create;var be=Object.defineProperty;var it=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var at=Object.getPrototypeOf,ft=Object.prototype.hasOwnProperty;var rr=(g,E)=>()=>(E||g((E={exports:{}}).exports,E),E.exports),st=(g,E)=>{for(var p in E)be(g,p,{get:E[p],enumerable:!0})},ge=(g,E,p,O)=>{if(E&&typeof E=="object"||typeof E=="function")for(let R of ot(E))!ft.call(g,R)&&R!==p&&be(g,R,{get:()=>E[R],enumerable:!(O=it(E,R))||O.enumerable});return g},oe=(g,E,p)=>(ge(g,E,"default"),p&&ge(p,E,"default")),tr=(g,E,p)=>(p=g!=null?nt(at(g)):{},ge(E||!g||!g.__esModule?be(p,"default",{value:g,enumerable:!0}):p,g)),ut=g=>ge(be({},"__esModule",{value:!0}),g);var re=(g,E,p)=>new Promise((O,R)=>{var j=A=>{try{Y(p.next(A))}catch(M){R(M)}},P=A=>{try{Y(p.throw(A))}catch(M){R(M)}},Y=A=>A.done?O(A.value):Promise.resolve(A.value).then(j,P);Y((p=p.apply(g,E)).next())});var ir=rr((nr,Le)=>{(function(g){if(typeof nr=="object"&&typeof Le<"u")Le.exports=g();else if(typeof define=="function"&&define.amd)define([],g);else{var E;typeof window<"u"?E=window:typeof global<"u"?E=global:typeof self<"u"?E=self:E=this,E.localforage=g()}})(function(){var g,E,p;return function O(R,j,P){function Y(K,J){if(!j[K]){if(!R[K]){var m=typeof require=="function"&&require;if(!J&&m)return m(K,!0);if(A)return A(K,!0);var w=new Error("Cannot find module '"+K+"'");throw w.code="MODULE_NOT_FOUND",w}var B=j[K]={exports:{}};R[K][0].call(B.exports,function(W){var Z=R[K][1][W];return Y(Z||W)},B,B.exports,O,R,j,P)}return j[K].exports}for(var A=typeof require=="function"&&require,M=0;M<P.length;M++)Y(P[M]);return Y}({1:[function(O,R,j){(function(P){"use strict";var Y=P.MutationObserver||P.WebKitMutationObserver,A;if(Y){var M=0,K=new Y(W),J=P.document.createTextNode("");K.observe(J,{characterData:!0}),A=function(){J.data=M=++M%2}}else if(!P.setImmediate&&typeof P.MessageChannel<"u"){var m=new P.MessageChannel;m.port1.onmessage=W,A=function(){m.port2.postMessage(0)}}else"document"in P&&"onreadystatechange"in P.document.createElement("script")?A=function(){var F=P.document.createElement("script");F.onreadystatechange=function(){W(),F.onreadystatechange=null,F.parentNode.removeChild(F),F=null},P.document.documentElement.appendChild(F)}:A=function(){setTimeout(W,0)};var w,B=[];function W(){w=!0;for(var F,k,U=B.length;U;){for(k=B,B=[],F=-1;++F<U;)k[F]();U=B.length}w=!1}R.exports=Z;function Z(F){B.push(F)===1&&!w&&A()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(O,R,j){"use strict";var P=O(1);function Y(){}var A={},M=["REJECTED"],K=["FULFILLED"],J=["PENDING"];R.exports=m;function m(h){if(typeof h!="function")throw new TypeError("resolver must be a function");this.state=J,this.queue=[],this.outcome=void 0,h!==Y&&Z(this,h)}m.prototype.catch=function(h){return this.then(null,h)},m.prototype.then=function(h,D){if(typeof h!="function"&&this.state===K||typeof D!="function"&&this.state===M)return this;var S=new this.constructor(Y);if(this.state!==J){var C=this.state===K?h:D;B(S,C,this.outcome)}else this.queue.push(new w(S,h,D));return S};function w(h,D,S){this.promise=h,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(h){A.resolve(this.promise,h)},w.prototype.otherCallFulfilled=function(h){B(this.promise,this.onFulfilled,h)},w.prototype.callRejected=function(h){A.reject(this.promise,h)},w.prototype.otherCallRejected=function(h){B(this.promise,this.onRejected,h)};function B(h,D,S){P(function(){var C;try{C=D(S)}catch(G){return A.reject(h,G)}C===h?A.reject(h,new TypeError("Cannot resolve promise with itself")):A.resolve(h,C)})}A.resolve=function(h,D){var S=F(W,D);if(S.status==="error")return A.reject(h,S.value);var C=S.value;if(C)Z(h,C);else{h.state=K,h.outcome=D;for(var G=-1,X=h.queue.length;++G<X;)h.queue[G].callFulfilled(D)}return h},A.reject=function(h,D){h.state=M,h.outcome=D;for(var S=-1,C=h.queue.length;++S<C;)h.queue[S].callRejected(D);return h};function W(h){var D=h&&h.then;if(h&&(typeof h=="object"||typeof h=="function")&&typeof D=="function")return function(){D.apply(h,arguments)}}function Z(h,D){var S=!1;function C($){S||(S=!0,A.reject(h,$))}function G($){S||(S=!0,A.resolve(h,$))}function X(){D(G,C)}var Q=F(X);Q.status==="error"&&C(Q.value)}function F(h,D){var S={};try{S.value=h(D),S.status="success"}catch(C){S.status="error",S.value=C}return S}m.resolve=k;function k(h){return h instanceof this?h:A.resolve(new this(Y),h)}m.reject=U;function U(h){var D=new this(Y);return A.reject(D,h)}m.all=ce;function ce(h){var D=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=h.length,C=!1;if(!S)return this.resolve([]);for(var G=new Array(S),X=0,Q=-1,$=new this(Y);++Q<S;)ee(h[Q],Q);return $;function ee(se,a){D.resolve(se).then(u,function(v){C||(C=!0,A.reject($,v))});function u(v){G[a]=v,++X===S&&!C&&(C=!0,A.resolve($,G))}}}m.race=ie;function ie(h){var D=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=h.length,C=!1;if(!S)return this.resolve([]);for(var G=-1,X=new this(Y);++G<S;)Q(h[G]);return X;function Q($){D.resolve($).then(function(ee){C||(C=!0,A.resolve(X,ee))},function(ee){C||(C=!0,A.reject(X,ee))})}}},{1:1}],3:[function(O,R,j){(function(P){"use strict";typeof P.Promise!="function"&&(P.Promise=O(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(O,R,j){"use strict";var P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var M=A();function K(){try{if(!M||!M.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||t)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function J(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(n){if(n.name!=="TypeError")throw n;for(var r=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,i=new r,o=0;o<e.length;o+=1)i.append(e[o]);return i.getBlob(t.type)}}typeof Promise>"u"&&O(3);var m=Promise;function w(e,t){t&&e.then(function(r){t(null,r)},function(r){t(r)})}function B(e,t,r){typeof t=="function"&&e.then(t),typeof r=="function"&&e.catch(r)}function W(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function Z(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var F="local-forage-detect-blob-support",k=void 0,U={},ce=Object.prototype.toString,ie="readonly",h="readwrite";function D(e){for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),o=0;o<t;o++)i[o]=e.charCodeAt(o);return r}function S(e){return new m(function(t){var r=e.transaction(F,h),i=J([""]);r.objectStore(F).put(i,"key"),r.onabort=function(o){o.preventDefault(),o.stopPropagation(),t(!1)},r.oncomplete=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!o||parseInt(o[1],10)>=43)}}).catch(function(){return!1})}function C(e){return typeof k=="boolean"?m.resolve(k):S(e).then(function(t){return k=t,k})}function G(e){var t=U[e.name],r={};r.promise=new m(function(i,o){r.resolve=i,r.reject=o}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function X(e){var t=U[e.name],r=t.deferredOperations.pop();if(r)return r.resolve(),r.promise}function Q(e,t){var r=U[e.name],i=r.deferredOperations.pop();if(i)return i.reject(t),i.promise}function $(e,t){return new m(function(r,i){if(U[e.name]=U[e.name]||V(),e.db)if(t)G(e),e.db.close();else return r(e.db);var o=[e.name];t&&o.push(e.version);var n=M.open.apply(M,o);t&&(n.onupgradeneeded=function(f){var s=n.result;try{s.createObjectStore(e.storeName),f.oldVersion<=1&&s.createObjectStore(F)}catch(c){if(c.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+f.oldVersion+" to version "+f.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw c}}),n.onerror=function(f){f.preventDefault(),i(n.error)},n.onsuccess=function(){var f=n.result;f.onversionchange=function(s){s.target.close()},r(f),X(e)}})}function ee(e){return $(e,!1)}function se(e){return $(e,!0)}function a(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),i=e.version<e.db.version,o=e.version>e.db.version;if(i&&(e.version!==t&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||r){if(r){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function u(e){return new m(function(t,r){var i=new FileReader;i.onerror=r,i.onloadend=function(o){var n=btoa(o.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},i.readAsBinaryString(e)})}function v(e){var t=D(atob(e.data));return J([t],{type:e.type})}function b(e){return e&&e.__local_forage_encoded_blob}function _(e){var t=this,r=t._initReady().then(function(){var i=U[t._dbInfo.name];if(i&&i.dbReady)return i.dbReady});return B(r,e,e),r}function I(e){G(e);for(var t=U[e.name],r=t.forages,i=0;i<r.length;i++){var o=r[i];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,ee(e).then(function(n){return e.db=n,a(e)?se(e):n}).then(function(n){e.db=t.db=n;for(var f=0;f<r.length;f++)r[f]._dbInfo.db=n}).catch(function(n){throw Q(e,n),n})}function N(e,t,r,i){i===void 0&&(i=1);try{var o=e.db.transaction(e.storeName,t);r(null,o)}catch(n){if(i>0&&(!e.db||n.name==="InvalidStateError"||n.name==="NotFoundError"))return m.resolve().then(function(){if(!e.db||n.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),se(e)}).then(function(){return I(e).then(function(){N(e,t,r,i-1)})}).catch(r);r(n)}}function V(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function le(e){var t=this,r={db:null};if(e)for(var i in e)r[i]=e[i];var o=U[r.name];o||(o=V(),U[r.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=_);var n=[];function f(){return m.resolve()}for(var s=0;s<o.forages.length;s++){var c=o.forages[s];c!==t&&n.push(c._initReady().catch(f))}var l=o.forages.slice(0);return m.all(n).then(function(){return r.db=o.db,ee(r)}).then(function(d){return r.db=d,a(r,t._defaultConfig.version)?se(r):d}).then(function(d){r.db=o.db=d,t._dbInfo=r;for(var y=0;y<l.length;y++){var T=l[y];T!==t&&(T._dbInfo.db=r.db,T._dbInfo.version=r.version)}})}function ue(e,t){var r=this;e=W(e);var i=new m(function(o,n){r.ready().then(function(){N(r._dbInfo,ie,function(f,s){if(f)return n(f);try{var c=s.objectStore(r._dbInfo.storeName),l=c.get(e);l.onsuccess=function(){var d=l.result;d===void 0&&(d=null),b(d)&&(d=v(d)),o(d)},l.onerror=function(){n(l.error)}}catch(d){n(d)}})}).catch(n)});return w(i,t),i}function ve(e,t){var r=this,i=new m(function(o,n){r.ready().then(function(){N(r._dbInfo,ie,function(f,s){if(f)return n(f);try{var c=s.objectStore(r._dbInfo.storeName),l=c.openCursor(),d=1;l.onsuccess=function(){var y=l.result;if(y){var T=y.value;b(T)&&(T=v(T));var x=e(T,y.key,d++);x!==void 0?o(x):y.continue()}else o()},l.onerror=function(){n(l.error)}}catch(y){n(y)}})}).catch(n)});return w(i,t),i}function ur(e,t,r){var i=this;e=W(e);var o=new m(function(n,f){var s;i.ready().then(function(){return s=i._dbInfo,ce.call(t)==="[object Blob]"?C(s.db).then(function(c){return c?t:u(t)}):t}).then(function(c){N(i._dbInfo,h,function(l,d){if(l)return f(l);try{var y=d.objectStore(i._dbInfo.storeName);c===null&&(c=void 0);var T=y.put(c,e);d.oncomplete=function(){c===void 0&&(c=null),n(c)},d.onabort=d.onerror=function(){var x=T.error?T.error:T.transaction.error;f(x)}}catch(x){f(x)}})}).catch(f)});return w(o,r),o}function cr(e,t){var r=this;e=W(e);var i=new m(function(o,n){r.ready().then(function(){N(r._dbInfo,h,function(f,s){if(f)return n(f);try{var c=s.objectStore(r._dbInfo.storeName),l=c.delete(e);s.oncomplete=function(){o()},s.onerror=function(){n(l.error)},s.onabort=function(){var d=l.error?l.error:l.transaction.error;n(d)}}catch(d){n(d)}})}).catch(n)});return w(i,t),i}function lr(e){var t=this,r=new m(function(i,o){t.ready().then(function(){N(t._dbInfo,h,function(n,f){if(n)return o(n);try{var s=f.objectStore(t._dbInfo.storeName),c=s.clear();f.oncomplete=function(){i()},f.onabort=f.onerror=function(){var l=c.error?c.error:c.transaction.error;o(l)}}catch(l){o(l)}})}).catch(o)});return w(r,e),r}function dr(e){var t=this,r=new m(function(i,o){t.ready().then(function(){N(t._dbInfo,ie,function(n,f){if(n)return o(n);try{var s=f.objectStore(t._dbInfo.storeName),c=s.count();c.onsuccess=function(){i(c.result)},c.onerror=function(){o(c.error)}}catch(l){o(l)}})}).catch(o)});return w(r,e),r}function vr(e,t){var r=this,i=new m(function(o,n){if(e<0){o(null);return}r.ready().then(function(){N(r._dbInfo,ie,function(f,s){if(f)return n(f);try{var c=s.objectStore(r._dbInfo.storeName),l=!1,d=c.openKeyCursor();d.onsuccess=function(){var y=d.result;if(!y){o(null);return}e===0||l?o(y.key):(l=!0,y.advance(e))},d.onerror=function(){n(d.error)}}catch(y){n(y)}})}).catch(n)});return w(i,t),i}function hr(e){var t=this,r=new m(function(i,o){t.ready().then(function(){N(t._dbInfo,ie,function(n,f){if(n)return o(n);try{var s=f.objectStore(t._dbInfo.storeName),c=s.openKeyCursor(),l=[];c.onsuccess=function(){var d=c.result;if(!d){i(l);return}l.push(d.key),d.continue()},c.onerror=function(){o(c.error)}}catch(d){o(d)}})}).catch(o)});return w(r,e),r}function mr(e,t){t=Z.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i=this,o;if(!e.name)o=m.reject("Invalid arguments");else{var n=e.name===r.name&&i._dbInfo.db,f=n?m.resolve(i._dbInfo.db):ee(e).then(function(s){var c=U[e.name],l=c.forages;c.db=s;for(var d=0;d<l.length;d++)l[d]._dbInfo.db=s;return s});e.storeName?o=f.then(function(s){if(!!s.objectStoreNames.contains(e.storeName)){var c=s.version+1;G(e);var l=U[e.name],d=l.forages;s.close();for(var y=0;y<d.length;y++){var T=d[y];T._dbInfo.db=null,T._dbInfo.version=c}var x=new m(function(L,H){var z=M.open(e.name,c);z.onerror=function(q){var me=z.result;me.close(),H(q)},z.onupgradeneeded=function(){var q=z.result;q.deleteObjectStore(e.storeName)},z.onsuccess=function(){var q=z.result;q.close(),L(q)}});return x.then(function(L){l.db=L;for(var H=0;H<d.length;H++){var z=d[H];z._dbInfo.db=L,X(z._dbInfo)}}).catch(function(L){throw(Q(e,L)||m.resolve()).catch(function(){}),L})}}):o=f.then(function(s){G(e);var c=U[e.name],l=c.forages;s.close();for(var d=0;d<l.length;d++){var y=l[d];y._dbInfo.db=null}var T=new m(function(x,L){var H=M.deleteDatabase(e.name);H.onerror=function(){var z=H.result;z&&z.close(),L(H.error)},H.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},H.onsuccess=function(){var z=H.result;z&&z.close(),x(z)}});return T.then(function(x){c.db=x;for(var L=0;L<l.length;L++){var H=l[L];X(H._dbInfo)}}).catch(function(x){throw(Q(e,x)||m.resolve()).catch(function(){}),x})})}return w(o,t),o}var yr={_driver:"asyncStorage",_initStorage:le,_support:K(),iterate:ve,getItem:ue,setItem:ur,removeItem:cr,clear:lr,length:dr,key:vr,keys:hr,dropInstance:mr};function pr(){return typeof openDatabase=="function"}var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gr="~~local_forage_type~",Me=/^~~local_forage_type~([^~]+)~/,ye="__lfsc__:",Ae=ye.length,Te="arbf",Re="blob",Fe="si08",Ue="ui08",Ye="uic8",We="si16",ze="si32",He="ur16",Ke="ui32",Ge="fl32",Ve="fl64",je=Ae+Te.length,Xe=Object.prototype.toString;function Qe(e){var t=e.length*.75,r=e.length,i,o=0,n,f,s,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=new ArrayBuffer(t),d=new Uint8Array(l);for(i=0;i<r;i+=4)n=ae.indexOf(e[i]),f=ae.indexOf(e[i+1]),s=ae.indexOf(e[i+2]),c=ae.indexOf(e[i+3]),d[o++]=n<<2|f>>4,d[o++]=(f&15)<<4|s>>2,d[o++]=(s&3)<<6|c&63;return l}function De(e){var t=new Uint8Array(e),r="",i;for(i=0;i<t.length;i+=3)r+=ae[t[i]>>2],r+=ae[(t[i]&3)<<4|t[i+1]>>4],r+=ae[(t[i+1]&15)<<2|t[i+2]>>6],r+=ae[t[i+2]&63];return t.length%3===2?r=r.substring(0,r.length-1)+"=":t.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function br(e,t){var r="";if(e&&(r=Xe.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&Xe.call(e.buffer)==="[object ArrayBuffer]")){var i,o=ye;e instanceof ArrayBuffer?(i=e,o+=Te):(i=e.buffer,r==="[object Int8Array]"?o+=Fe:r==="[object Uint8Array]"?o+=Ue:r==="[object Uint8ClampedArray]"?o+=Ye:r==="[object Int16Array]"?o+=We:r==="[object Uint16Array]"?o+=He:r==="[object Int32Array]"?o+=ze:r==="[object Uint32Array]"?o+=Ke:r==="[object Float32Array]"?o+=Ge:r==="[object Float64Array]"?o+=Ve:t(new Error("Failed to get type for BinaryArray"))),t(o+De(i))}else if(r==="[object Blob]"){var n=new FileReader;n.onload=function(){var f=gr+e.type+"~"+De(this.result);t(ye+Re+f)},n.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(f){console.error("Couldn't convert value into a JSON string: ",e),t(null,f)}}function _r(e){if(e.substring(0,Ae)!==ye)return JSON.parse(e);var t=e.substring(je),r=e.substring(Ae,je),i;if(r===Re&&Me.test(t)){var o=t.match(Me);i=o[1],t=t.substring(o[0].length)}var n=Qe(t);switch(r){case Te:return n;case Re:return J([n],{type:i});case Fe:return new Int8Array(n);case Ue:return new Uint8Array(n);case Ye:return new Uint8ClampedArray(n);case We:return new Int16Array(n);case He:return new Uint16Array(n);case ze:return new Int32Array(n);case Ke:return new Uint32Array(n);case Ge:return new Float32Array(n);case Ve:return new Float64Array(n);default:throw new Error("Unkown type: "+r)}}var Ne={serialize:br,deserialize:_r,stringToBuffer:Qe,bufferToString:De};function $e(e,t,r,i){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,i)}function wr(e){var t=this,r={db:null};if(e)for(var i in e)r[i]=typeof e[i]!="string"?e[i].toString():e[i];var o=new m(function(n,f){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(s){return f(s)}r.db.transaction(function(s){$e(s,r,function(){t._dbInfo=r,n()},function(c,l){f(l)})},f)});return r.serializer=Ne,o}function fe(e,t,r,i,o,n){e.executeSql(r,i,o,function(f,s){s.code===s.SYNTAX_ERR?f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(c,l){l.rows.length?n(c,s):$e(c,t,function(){c.executeSql(r,i,o,n)},n)},n):n(f,s)},n)}function Ir(e,t){var r=this;e=W(e);var i=new m(function(o,n){r.ready().then(function(){var f=r._dbInfo;f.db.transaction(function(s){fe(s,f,"SELECT * FROM "+f.storeName+" WHERE key = ? LIMIT 1",[e],function(c,l){var d=l.rows.length?l.rows.item(0).value:null;d&&(d=f.serializer.deserialize(d)),o(d)},function(c,l){n(l)})})}).catch(n)});return w(i,t),i}function Er(e,t){var r=this,i=new m(function(o,n){r.ready().then(function(){var f=r._dbInfo;f.db.transaction(function(s){fe(s,f,"SELECT * FROM "+f.storeName,[],function(c,l){for(var d=l.rows,y=d.length,T=0;T<y;T++){var x=d.item(T),L=x.value;if(L&&(L=f.serializer.deserialize(L)),L=e(L,x.key,T+1),L!==void 0){o(L);return}}o()},function(c,l){n(l)})})}).catch(n)});return w(i,t),i}function Je(e,t,r,i){var o=this;e=W(e);var n=new m(function(f,s){o.ready().then(function(){t===void 0&&(t=null);var c=t,l=o._dbInfo;l.serializer.serialize(t,function(d,y){y?s(y):l.db.transaction(function(T){fe(T,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,d],function(){f(c)},function(x,L){s(L)})},function(T){if(T.code===T.QUOTA_ERR){if(i>0){f(Je.apply(o,[e,c,r,i-1]));return}s(T)}})})}).catch(s)});return w(n,r),n}function Sr(e,t,r){return Je.apply(this,[e,t,r,1])}function Ar(e,t){var r=this;e=W(e);var i=new m(function(o,n){r.ready().then(function(){var f=r._dbInfo;f.db.transaction(function(s){fe(s,f,"DELETE FROM "+f.storeName+" WHERE key = ?",[e],function(){o()},function(c,l){n(l)})})}).catch(n)});return w(i,t),i}function Tr(e){var t=this,r=new m(function(i,o){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(f){fe(f,n,"DELETE FROM "+n.storeName,[],function(){i()},function(s,c){o(c)})})}).catch(o)});return w(r,e),r}function Rr(e){var t=this,r=new m(function(i,o){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(f){fe(f,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(s,c){var l=c.rows.item(0).c;i(l)},function(s,c){o(c)})})}).catch(o)});return w(r,e),r}function Dr(e,t){var r=this,i=new m(function(o,n){r.ready().then(function(){var f=r._dbInfo;f.db.transaction(function(s){fe(s,f,"SELECT key FROM "+f.storeName+" WHERE id = ? LIMIT 1",[e+1],function(c,l){var d=l.rows.length?l.rows.item(0).key:null;o(d)},function(c,l){n(l)})})}).catch(n)});return w(i,t),i}function Nr(e){var t=this,r=new m(function(i,o){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(f){fe(f,n,"SELECT key FROM "+n.storeName,[],function(s,c){for(var l=[],d=0;d<c.rows.length;d++)l.push(c.rows.item(d).key);i(l)},function(s,c){o(c)})})}).catch(o)});return w(r,e),r}function Br(e){return new m(function(t,r){e.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(o,n){for(var f=[],s=0;s<n.rows.length;s++)f.push(n.rows.item(s).name);t({db:e,storeNames:f})},function(o,n){r(n)})},function(i){r(i)})})}function xr(e,t){t=Z.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var i=this,o;return e.name?o=new m(function(n){var f;e.name===r.name?f=i._dbInfo.db:f=openDatabase(e.name,"","",0),e.storeName?n({db:f,storeNames:[e.storeName]}):n(Br(f))}).then(function(n){return new m(function(f,s){n.db.transaction(function(c){function l(x){return new m(function(L,H){c.executeSql("DROP TABLE IF EXISTS "+x,[],function(){L()},function(z,q){H(q)})})}for(var d=[],y=0,T=n.storeNames.length;y<T;y++)d.push(l(n.storeNames[y]));m.all(d).then(function(){f()}).catch(function(x){s(x)})},function(c){s(c)})})}):o=m.reject("Invalid arguments"),w(o,t),o}var Or={_driver:"webSQLStorage",_initStorage:wr,_support:pr(),iterate:Er,getItem:Ir,setItem:Sr,removeItem:Ar,clear:Tr,length:Rr,key:Dr,keys:Nr,dropInstance:xr};function Cr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ze(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function Lr(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}function Pr(){return!Lr()||localStorage.length>0}function Mr(e){var t=this,r={};if(e)for(var i in e)r[i]=e[i];return r.keyPrefix=Ze(e,t._defaultConfig),Pr()?(t._dbInfo=r,r.serializer=Ne,m.resolve()):m.reject()}function Fr(e){var t=this,r=t.ready().then(function(){for(var i=t._dbInfo.keyPrefix,o=localStorage.length-1;o>=0;o--){var n=localStorage.key(o);n.indexOf(i)===0&&localStorage.removeItem(n)}});return w(r,e),r}function Ur(e,t){var r=this;e=W(e);var i=r.ready().then(function(){var o=r._dbInfo,n=localStorage.getItem(o.keyPrefix+e);return n&&(n=o.serializer.deserialize(n)),n});return w(i,t),i}function Yr(e,t){var r=this,i=r.ready().then(function(){for(var o=r._dbInfo,n=o.keyPrefix,f=n.length,s=localStorage.length,c=1,l=0;l<s;l++){var d=localStorage.key(l);if(d.indexOf(n)===0){var y=localStorage.getItem(d);if(y&&(y=o.serializer.deserialize(y)),y=e(y,d.substring(f),c++),y!==void 0)return y}}});return w(i,t),i}function Wr(e,t){var r=this,i=r.ready().then(function(){var o=r._dbInfo,n;try{n=localStorage.key(e)}catch{n=null}return n&&(n=n.substring(o.keyPrefix.length)),n});return w(i,t),i}function zr(e){var t=this,r=t.ready().then(function(){for(var i=t._dbInfo,o=localStorage.length,n=[],f=0;f<o;f++){var s=localStorage.key(f);s.indexOf(i.keyPrefix)===0&&n.push(s.substring(i.keyPrefix.length))}return n});return w(r,e),r}function Hr(e){var t=this,r=t.keys().then(function(i){return i.length});return w(r,e),r}function Kr(e,t){var r=this;e=W(e);var i=r.ready().then(function(){var o=r._dbInfo;localStorage.removeItem(o.keyPrefix+e)});return w(i,t),i}function Gr(e,t,r){var i=this;e=W(e);var o=i.ready().then(function(){t===void 0&&(t=null);var n=t;return new m(function(f,s){var c=i._dbInfo;c.serializer.serialize(t,function(l,d){if(d)s(d);else try{localStorage.setItem(c.keyPrefix+e,l),f(n)}catch(y){(y.name==="QuotaExceededError"||y.name==="NS_ERROR_DOM_QUOTA_REACHED")&&s(y),s(y)}})})});return w(o,r),o}function Vr(e,t){if(t=Z.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var i=this,o;return e.name?o=new m(function(n){e.storeName?n(Ze(e,i._defaultConfig)):n(e.name+"/")}).then(function(n){for(var f=localStorage.length-1;f>=0;f--){var s=localStorage.key(f);s.indexOf(n)===0&&localStorage.removeItem(s)}}):o=m.reject("Invalid arguments"),w(o,t),o}var jr={_driver:"localStorageWrapper",_initStorage:Mr,_support:Cr(),iterate:Yr,getItem:Ur,setItem:Gr,removeItem:Kr,clear:Fr,length:Hr,key:Wr,keys:zr,dropInstance:Vr},Xr=function(t,r){return t===r||typeof t=="number"&&typeof r=="number"&&isNaN(t)&&isNaN(r)},Qr=function(t,r){for(var i=t.length,o=0;o<i;){if(Xr(t[o],r))return!0;o++}return!1},qe=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},he={},ke={},de={INDEXEDDB:yr,WEBSQL:Or,LOCALSTORAGE:jr},$r=[de.INDEXEDDB._driver,de.WEBSQL._driver,de.LOCALSTORAGE._driver],pe=["dropInstance"],Be=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(pe),Jr={description:"",driver:$r.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Zr(e,t){e[t]=function(){var r=arguments;return e.ready().then(function(){return e[t].apply(e,r)})}}function xe(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(qe(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var qr=function(){function e(t){Y(this,e);for(var r in de)if(de.hasOwnProperty(r)){var i=de[r],o=i._driver;this[r]=o,he[o]||this.defineDriver(i)}this._defaultConfig=xe({},Jr),this._config=xe({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(r){if((typeof r>"u"?"undefined":P(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in r){if(i==="storeName"&&(r[i]=r[i].replace(/\W/g,"_")),i==="version"&&typeof r[i]!="number")return new Error("Database version must be a number.");this._config[i]=r[i]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},e.prototype.defineDriver=function(r,i,o){var n=new m(function(f,s){try{var c=r._driver,l=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){s(l);return}for(var d=Be.concat("_initStorage"),y=0,T=d.length;y<T;y++){var x=d[y],L=!Qr(pe,x);if((L||r[x])&&typeof r[x]!="function"){s(l);return}}var H=function(){for(var me=function(rt){return function(){var tt=new Error("Method "+rt+" is not implemented by the current driver"),er=m.reject(tt);return w(er,arguments[arguments.length-1]),er}},Oe=0,et=pe.length;Oe<et;Oe++){var Ce=pe[Oe];r[Ce]||(r[Ce]=me(Ce))}};H();var z=function(me){he[c]&&console.info("Redefining LocalForage driver: "+c),he[c]=r,ke[c]=me,f()};"_support"in r?r._support&&typeof r._support=="function"?r._support().then(z,s):z(!!r._support):z(!0)}catch(q){s(q)}});return B(n,i,o),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(r,i,o){var n=he[r]?m.resolve(he[r]):m.reject(new Error("Driver not found."));return B(n,i,o),n},e.prototype.getSerializer=function(r){var i=m.resolve(Ne);return B(i,r),i},e.prototype.ready=function(r){var i=this,o=i._driverSet.then(function(){return i._ready===null&&(i._ready=i._initDriver()),i._ready});return B(o,r,r),o},e.prototype.setDriver=function(r,i,o){var n=this;qe(r)||(r=[r]);var f=this._getSupportedDrivers(r);function s(){n._config.driver=n.driver()}function c(y){return n._extend(y),s(),n._ready=n._initStorage(n._config),n._ready}function l(y){return function(){var T=0;function x(){for(;T<y.length;){var L=y[T];return T++,n._dbInfo=null,n._ready=null,n.getDriver(L).then(c).catch(x)}s();var H=new Error("No available storage method found.");return n._driverSet=m.reject(H),n._driverSet}return x()}}var d=this._driverSet!==null?this._driverSet.catch(function(){return m.resolve()}):m.resolve();return this._driverSet=d.then(function(){var y=f[0];return n._dbInfo=null,n._ready=null,n.getDriver(y).then(function(T){n._driver=T._driver,s(),n._wrapLibraryMethodsWithReady(),n._initDriver=l(f)})}).catch(function(){s();var y=new Error("No available storage method found.");return n._driverSet=m.reject(y),n._driverSet}),B(this._driverSet,i,o),this._driverSet},e.prototype.supports=function(r){return!!ke[r]},e.prototype._extend=function(r){xe(this,r)},e.prototype._getSupportedDrivers=function(r){for(var i=[],o=0,n=r.length;o<n;o++){var f=r[o];this.supports(f)&&i.push(f)}return i},e.prototype._wrapLibraryMethodsWithReady=function(){for(var r=0,i=Be.length;r<i;r++)Zr(this,Be[r])},e.prototype.createInstance=function(r){return new e(r)},e}(),kr=new qr;R.exports=kr},{3:3}]},{},[4])(4)})});var ar=rr((_e,or)=>{(function(g,E){typeof _e=="object"&&typeof or<"u"?E(_e):typeof define=="function"&&define.amd?define("localforage-driver-memory",["exports"],E):E(g.LocalforageDriverMemory={})})(typeof self<"u"?self:_e,function(g){"use strict";var E="localforage-driver-memory";function p(a){var u=typeof Symbol=="function"&&a[Symbol.iterator],v=0;return u?u.call(a):{next:function(){return a&&v>=a.length&&(a=void 0),{value:a&&a[v++],done:!a}}}}function O(a,u){a=a||[],u=u||{};try{return new Blob(a,u)}catch(I){if(I.name!=="TypeError")throw I;for(var v=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,b=new v,_=0;_<a.length;_+=1)b.append(a[_]);return b.getBlob(u.type)}}var R=/^~~local_forage_type~([^~]+)~/,j=9,P=j+4,Y=Object.prototype.toString;function A(a){var u=a.length*.75,v=a.length;a[a.length-1]==="="&&(u--,a[a.length-2]==="="&&u--);for(var b=new ArrayBuffer(u),_=new Uint8Array(b),I=0,N=0;I<v;I+=4){var V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[I]),le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[I+1]),ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[I+2]),ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[I+3]);_[N++]=V<<2|le>>4,_[N++]=(le&15)<<4|ue>>2,_[N++]=(ue&3)<<6|ve&63}return b}function M(a){for(var u=new Uint8Array(a),v="",b=0;b<u.length;b+=3)v+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u[b]>>2],v+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(u[b]&3)<<4|u[b+1]>>4],v+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(u[b+1]&15)<<2|u[b+2]>>6],v+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u[b+2]&63];return u.length%3===2?v=v.substring(0,v.length-1)+"=":u.length%3===1&&(v=v.substring(0,v.length-2)+"=="),v}function K(a,u){var v="";if(a&&(v=Y.call(a)),a&&(v==="[object ArrayBuffer]"||a.buffer&&Y.call(a.buffer)==="[object ArrayBuffer]")){var b=void 0,_="__lfsc__:";a instanceof ArrayBuffer?(b=a,_+="arbf"):(b=a.buffer,v==="[object Int8Array]"?_+="si08":v==="[object Uint8Array]"?_+="ui08":v==="[object Uint8ClampedArray]"?_+="uic8":v==="[object Int16Array]"?_+="si16":v==="[object Uint16Array]"?_+="ur16":v==="[object Int32Array]"?_+="si32":v==="[object Uint32Array]"?_+="ui32":v==="[object Float32Array]"?_+="fl32":v==="[object Float64Array]"?_+="fl64":u(new Error("Failed to get type for BinaryArray"))),u(_+M(b))}else if(v==="[object Blob]"){var I=new FileReader;I.onload=function(){var N="~~local_forage_type~"+a.type+"~"+M(this.result);u("__lfsc__:blob"+N)},I.readAsArrayBuffer(a)}else try{u(JSON.stringify(a))}catch(N){console.error("Couldn't convert value into a JSON string: ",a),u(null,N)}}function J(a){if(a.substring(0,j)!=="__lfsc__:")return JSON.parse(a);var u=a.substring(P),v=a.substring(j,P),b;if(v==="blob"&&R.test(u)){var _=u.match(R);b=_[1],u=u.substring(_[0].length)}var I=A(u);switch(v){case"arbf":return I;case"blob":return O([I],{type:b});case"si08":return new Int8Array(I);case"ui08":return new Uint8Array(I);case"uic8":return new Uint8ClampedArray(I);case"si16":return new Int16Array(I);case"ur16":return new Uint16Array(I);case"si32":return new Int32Array(I);case"ui32":return new Uint32Array(I);case"fl32":return new Float32Array(I);case"fl64":return new Float64Array(I);default:throw new Error("Unkown type: "+v)}}function m(a){var u,v;if(a===null||typeof a!="object"||"isActiveClone"in a)return a;var b=a instanceof Date?new Date(a):a.constructor();try{for(var _=p(Object.keys(a)),I=_.next();!I.done;I=_.next()){var N=I.value;Object.prototype.hasOwnProperty.call(a,N)&&(a.isActiveClone=null,b[N]=m(a[N]),delete a.isActiveClone)}}catch(V){u={error:V}}finally{try{I&&!I.done&&(v=_.return)&&v.call(_)}finally{if(u)throw u.error}}return b}function w(a,u){return(a.name||u.name)+"/"+(a.storeName||u.storeName)+"/"}function B(a,u){u&&a.then(function(v){u(null,v)},function(v){u(v)})}function W(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}function Z(a,u){var v=this;if(u=W.apply(this,arguments),a=typeof a!="function"&&a||{},!a.name){var b=this.config();a.name=a.name||b.name,a.storeName=a.storeName||b.storeName}var _;return a.name?_=new Promise(function(I){a.storeName?I(w(a,v._defaultConfig)):I(a.name+"/")}):_=Promise.reject("Invalid arguments"),{promise:_,callback:u}}function F(a){return typeof a!="string"&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}var k={bufferToString:M,deserialize:J,serialize:K,stringToBuffer:A},U={},ce=function(){function a(u){this.kp=u,this.data={}}return a.resolve=function(u){return U[u]||(U[u]=new a(u)),U[u]},a.prototype.clear=function(){this.data={}},a.prototype.drop=function(){this.clear(),delete U[this.kp]},a.prototype.get=function(u){return this.data[u]},a.prototype.key=function(u){return this.keys()[u]},a.prototype.keys=function(){return Object.keys(this.data)},a.prototype.rm=function(u){delete this.data[u]},a.prototype.set=function(u,v){this.data[u]=v},a}();function ie(a){var u=a?m(a):{},v=w(u,this._defaultConfig),b=ce.resolve(v);return this._dbInfo=u,this._dbInfo.serializer=k,this._dbInfo.keyPrefix=v,this._dbInfo.mStore=b,Promise.resolve()}function h(a){var u=this,v=this.ready().then(function(){u._dbInfo.mStore.clear()});return B(v,a),v}function D(a,u){var v=Z.apply(this,arguments),b=v.promise,_=v.callback,I=b.then(function(N){ce.resolve(N).drop()});return B(I,_),b}function S(a,u){var v=this;a=F(a);var b=this.ready().then(function(){var _=v._dbInfo.mStore.get(a);return _==null?null:v._dbInfo.serializer.deserialize(_)});return B(b,u),b}function C(a,u){var v=this,b=this.ready().then(function(){for(var _=v._dbInfo.mStore,I=_.keys(),N=0;N<I.length;N++){var V=_.get(I[N]);if(V&&(V=v._dbInfo.serializer.deserialize(V)),V=a(V,I[N],N+1),V!==void 0)return V}});return B(b,u),b}function G(a,u){var v=this,b=this.ready().then(function(){var _;try{_=v._dbInfo.mStore.key(a),_===void 0&&(_=null)}catch{_=null}return _});return B(b,u),b}function X(a){var u=this,v=this.ready().then(function(){return u._dbInfo.mStore.keys()});return B(v,a),v}function Q(a){var u=this.keys().then(function(v){return v.length});return B(u,a),u}function $(a,u){var v=this;a=F(a);var b=this.ready().then(function(){v._dbInfo.mStore.rm(a)});return B(b,u),b}function ee(a,u,v){var b=this;a=F(a);var _=this.ready().then(function(){u===void 0&&(u=null);var I=u;return new Promise(function(N,V){b._dbInfo.serializer.serialize(u,function(le,ue){if(ue)V(ue);else try{b._dbInfo.mStore.set(a,le),N(I)}catch(ve){V(ve)}})})});return B(_,v),_}var se=!0;g._support=se,g._driver=E,g._initStorage=ie,g.clear=h,g.dropInstance=D,g.getItem=S,g.iterate=C,g.key=G,g.keys=X,g.length=Q,g.removeItem=$,g.setItem=ee,Object.defineProperty(g,"__esModule",{value:!0})})});var ne={};st(ne,{Magic:()=>yt});module.exports=ut(ne);var Se=require("@magic-sdk/provider"),Ee=tr(ir()),Pe=tr(ar());var te=require("@magic-sdk/provider"),Ie=require("@magic-sdk/types");var ct={display:"block",visibility:"hidden",position:"fixed",top:"0",right:"0",width:"100%",height:"100%",borderRadius:"0",border:"none",zIndex:"2147483647",opacity:"0"};function lt(g){for(let[E,p]of Object.entries(ct))g.style[E]=p}function dt(g){let E=[].slice.call(document.querySelectorAll(".magic-iframe"));return Boolean(E.find(p=>p.src.includes(g)))}var fr=1e3,sr=60*fr,vt=15*fr,ht=2*sr,mt=60*sr,we=class extends te.ViewController{constructor(){super(...arguments);this.activeElement=null;this.lastPingTime=Date.now();this.intervalTimer=null;this.timeoutTimer=null}getIframeSrc(){return(0,te.createURL)(`/send?params=${encodeURIComponent(this.parameters)}`,this.endpoint).href}init(){this.test="hello",this.iframe=new Promise(p=>{let O=()=>{if(dt(encodeURIComponent(this.parameters)))(0,te.createDuplicateIframeWarning)().log();else{let R=document.createElement("iframe");R.classList.add("magic-iframe"),R.dataset.magicIframeLabel=(0,te.createURL)(this.endpoint).host,R.title="Secure Modal",R.src=this.getIframeSrc(),R.allow="clipboard-read; clipboard-write",lt(R),document.body.appendChild(R),p(R)}};["loaded","interactive","complete"].includes(document.readyState)?O():window.addEventListener("load",O,!1)}),this.iframe.then(p=>{p instanceof HTMLIFrameElement&&p.addEventListener("load",()=>re(this,null,function*(){yield this.startHeartBeat()}))}),window.addEventListener("message",p=>{var O;if(p.origin===this.endpoint&&p.data&&p.data.msgType&&this.messageHandlers.size){p.data.msgType.includes(Ie.MagicIncomingWindowMessage.MAGIC_PONG)&&(this.lastPingTime=Date.now()),p.data.response=(O=p.data.response)!=null?O:{};for(let j of this.messageHandlers.values())j(p)}}),window.addEventListener("beforeunload",()=>{this.stopHeartBeat()})}showOverlay(){return re(this,null,function*(){let p=yield this.iframe;p.style.visibility="visible",p.style.opacity="1",this.activeElement=document.activeElement,p.focus()})}hideOverlay(){return re(this,null,function*(){var O;let p=yield this.iframe;p.style.visibility="hidden",p.style.opacity="0",(O=this.activeElement)!=null&&O.focus&&this.activeElement.focus(),this.activeElement=null})}_post(p){return re(this,null,function*(){let O=yield this.iframe;if(O&&O.contentWindow)O.contentWindow.postMessage(p,this.endpoint);else throw(0,te.createModalNotReadyError)()})}heartBeatCheck(){this.intervalTimer=setInterval(()=>re(this,null,function*(){let p={msgType:`${Ie.MagicOutgoingWindowMessage.MAGIC_PING}-${this.parameters}`,payload:[]};yield this._post(p),Date.now()-this.lastPingTime>vt&&(yield this.reloadIframe(),this.lastPingTime=Date.now())}),ht)}startHeartBeat(){return re(this,null,function*(){(yield this.iframe)&&(this.timeoutTimer=setTimeout(()=>this.heartBeatCheck(),mt))})}stopHeartBeat(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null),this.intervalTimer&&(clearInterval(this.intervalTimer),this.intervalTimer=null)}reloadIframe(){return re(this,null,function*(){let p=yield this.iframe;if(p)p.src=this.getIframeSrc();else throw(0,te.createModalNotReadyError)()})}};oe(ne,require("@magic-sdk/commons"),module.exports);var yt=(0,Se.createSDK)(Se.SDKBase,{platform:"web",sdkName:"magic-sdk",version:"28.21.0",defaultEndpoint:"https://auth.magic.link/",ViewController:we,configureStorage:()=>re(void 0,null,function*(){let g=Ee.default.createInstance({name:"MagicAuthLocalStorageDB",storeName:"MagicAuthLocalStorage"});return yield g.defineDriver(Pe),yield g.setDriver([Ee.default.INDEXEDDB,Ee.default.LOCALSTORAGE,Pe._driver]),g})});
//# sourceMappingURL=index.js.map
